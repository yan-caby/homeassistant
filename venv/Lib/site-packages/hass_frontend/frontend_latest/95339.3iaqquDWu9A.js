export const id=95339;export const ids=[95339];export const modules={11753:(e,t,i)=>{i.d(t,{A:()=>r});const a=e=>{const t=parseFloat(e);if(isNaN(t))throw new Error(`${e} is not a number`);return t};function r(e){if(!e)return null;try{if(e.endsWith("%"))return{w:100,h:a(e.substr(0,e.length-1))};const t=e.replace(":","x").split("x");return 0===t.length?null:1===t.length?{w:a(t[0]),h:1}:{w:a(t[0]),h:a(t[1])}}catch(e){}return null}},69081:(e,t,i)=>{var a=i(62659),r=i(76504),s=i(80792),o=i(40924),n=i(18791),d=i(6699),l=i(82931),h=i(16327),c=i(43638),u=(i(12586),i(77664));i(12261);(0,a.A)([(0,n.EM)("ha-web-rtc-player")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"entityid",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"controls"})],key:"controls",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"muted"})],key:"muted",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"autoplay"})],key:"autoPlay",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"playsinline"})],key:"playsInline",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)()],key:"posterUrl",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,n.P)("#remote-stream")],key:"_videoEl",value:void 0},{kind:"field",key:"_peerConnection",value:void 0},{kind:"field",key:"_remoteStream",value:void 0},{kind:"method",key:"render",value:function(){return this._error?o.qy`<ha-alert alert-type="error">${this._error}</ha-alert>`:o.qy` <video id="remote-stream" ?autoplay="${this.autoPlay}" .muted="${this.muted}" ?playsinline="${this.playsInline}" ?controls="${this.controls}" .poster="${this.posterUrl}" @loadeddata="${this._loadedData}"></video> `}},{kind:"method",key:"connectedCallback",value:function(){(0,r.A)((0,s.A)(i.prototype),"connectedCallback",this).call(this),this.hasUpdated&&this._startWebRtc()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,r.A)((0,s.A)(i.prototype),"disconnectedCallback",this).call(this),this._cleanUp()}},{kind:"method",key:"updated",value:function(e){e.has("entityid")&&this._videoEl&&this._startWebRtc()}},{kind:"method",key:"_startWebRtc",value:async function(){this._error=void 0;const e=await this._fetchPeerConfiguration(),t=new RTCPeerConnection(e);t.createDataChannel("dataSendChannel"),t.addTransceiver("audio",{direction:"recvonly"}),t.addTransceiver("video",{direction:"recvonly"});const i=await t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});await t.setLocalDescription(i);let a="";const r=new Promise((e=>{t.addEventListener("icecandidate",(async t=>{t.candidate?a+=`a=${t.candidate.candidate}\r\n`:e()}))}));await r;const s=i.sdp+a;let o;try{o=await(0,c.ey)(this.hass,this.entityid,s)}catch(e){return this._error="Failed to start WebRTC stream: "+e.message,void t.close()}const n=new MediaStream;t.addEventListener("track",(e=>{n.addTrack(e.track),this._videoEl.srcObject=n})),this._remoteStream=n;const d=new RTCSessionDescription({type:"answer",sdp:o.answer});try{await t.setRemoteDescription(d)}catch(e){return this._error="Failed to connect WebRTC stream: "+e.message,void t.close()}this._peerConnection=t}},{kind:"method",key:"_fetchPeerConfiguration",value:async function(){if(!(0,d.x)(this.hass,"rtsp_to_webrtc"))return{};const e=await(async e=>e.callWS({type:"rtsp_to_webrtc/get_settings"}))(this.hass);return e&&e.stun_server?{iceServers:[{urls:[`stun:${e.stun_server}`]}]}:{}}},{kind:"method",key:"_cleanUp",value:function(){this._remoteStream&&(this._remoteStream.getTracks().forEach((e=>{e.stop()})),this._remoteStream=void 0),this._videoEl&&(this._videoEl.removeAttribute("src"),this._videoEl.load()),this._peerConnection&&(this._peerConnection.close(),this._peerConnection=void 0)}},{kind:"method",key:"_loadedData",value:function(){(0,u.r)(this,"load")}},{kind:"get",static:!0,key:"styles",value:function(){return o.AH`:host,video{display:block}video{width:100%;max-height:var(--video-max-height,calc(100vh - 97px))}`}}]}}),o.WF),(0,a.A)([(0,n.EM)("ha-camera-stream")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"stateObj",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"controls"})],key:"controls",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"muted"})],key:"muted",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"allow-exoplayer"})],key:"allowExoPlayer",value:()=>!1},{kind:"field",decorators:[(0,n.wk)()],key:"_posterUrl",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_forceMJPEG",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_url",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_connected",value:()=>!1},{kind:"method",key:"willUpdate",value:function(e){var t;e.has("stateObj")&&!this._shouldRenderMJPEG&&this.stateObj&&(null===(t=e.get("stateObj"))||void 0===t?void 0:t.entity_id)!==this.stateObj.entity_id&&(this._getPosterUrl(),this.stateObj.attributes.frontend_stream_type===c.Ub&&(this._forceMJPEG=void 0,this._url=void 0,this._getStreamUrl()))}},{kind:"method",key:"connectedCallback",value:function(){(0,r.A)((0,s.A)(i.prototype),"connectedCallback",this).call(this),this._connected=!0}},{kind:"method",key:"disconnectedCallback",value:function(){(0,r.A)((0,s.A)(i.prototype),"disconnectedCallback",this).call(this),this._connected=!1}},{kind:"method",key:"render",value:function(){return this.stateObj?this._shouldRenderMJPEG?o.qy`<img .src="${this._connected?(0,c.CK)(this.stateObj):""}" .alt="${`Preview of the ${(0,l.u)(this.stateObj)} camera.`}">`:this.stateObj.attributes.frontend_stream_type===c.Ub?this._url?o.qy`<ha-hls-player autoplay playsinline .allowExoPlayer="${this.allowExoPlayer}" .muted="${this.muted}" .controls="${this.controls}" .hass="${this.hass}" .url="${this._url}" .posterUrl="${this._posterUrl}"></ha-hls-player>`:o.s6:this.stateObj.attributes.frontend_stream_type===c.zS?o.qy`<ha-web-rtc-player autoplay playsinline .muted="${this.muted}" .controls="${this.controls}" .hass="${this.hass}" .entityid="${this.stateObj.entity_id}" .posterUrl="${this._posterUrl}"></ha-web-rtc-player>`:o.s6:o.s6}},{kind:"get",key:"_shouldRenderMJPEG",value:function(){return this._forceMJPEG===this.stateObj.entity_id||(!(0,h.$)(this.stateObj,c.JT)||(this.stateObj.attributes.frontend_stream_type===c.zS?"undefined"==typeof RTCPeerConnection:!(0,d.x)(this.hass,"stream")))}},{kind:"method",key:"_getPosterUrl",value:async function(){try{this._posterUrl=await(0,c.C4)(this.hass,this.stateObj.entity_id,this.clientWidth,this.clientHeight)}catch(e){this._posterUrl=void 0}}},{kind:"method",key:"_getStreamUrl",value:async function(){try{const{url:e}=await(0,c.wv)(this.hass,this.stateObj.entity_id);this._url=e}catch(e){console.error(e),this._forceMJPEG=this.stateObj.entity_id}}},{kind:"get",static:!0,key:"styles",value:function(){return o.AH`:host,img{display:block}img{width:100%}`}}]}}),o.WF)},12586:(e,t,i)=>{var a=i(62659),r=i(76504),s=i(80792),o=i(40924),n=i(18791),d=i(77664),l=i(34800);i(12261);(0,a.A)([(0,n.EM)("ha-hls-player")],(function(e,t){class a extends t{constructor(...t){super(...t),e(this)}}return{F:a,d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"url",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"posterUrl",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"controls"})],key:"controls",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"muted"})],key:"muted",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"autoplay"})],key:"autoPlay",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"playsinline"})],key:"playsInline",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"allow-exoplayer"})],key:"allowExoPlayer",value:()=>!1},{kind:"field",decorators:[(0,n.P)("video")],key:"_videoEl",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_errorIsFatal",value:()=>!1},{kind:"field",key:"_hlsPolyfillInstance",value:void 0},{kind:"field",key:"_exoPlayer",value:()=>!1},{kind:"field",static:!0,key:"streamCount",value:()=>0},{kind:"method",key:"connectedCallback",value:function(){(0,r.A)((0,s.A)(a.prototype),"connectedCallback",this).call(this),a.streamCount+=1,this.hasUpdated&&(this._resetError(),this._startHls())}},{kind:"method",key:"disconnectedCallback",value:function(){(0,r.A)((0,s.A)(a.prototype),"disconnectedCallback",this).call(this),a.streamCount-=1,this._cleanUp()}},{kind:"method",key:"render",value:function(){return o.qy` ${this._error?o.qy`<ha-alert alert-type="error" class="${this._errorIsFatal?"fatal":"retry"}"> ${this._error} </ha-alert>`:""} ${this._errorIsFatal?"":o.qy`<video .poster="${this.posterUrl}" ?autoplay="${this.autoPlay}" .muted="${this.muted}" ?playsinline="${this.playsInline}" ?controls="${this.controls}" @loadeddata="${this._loadedData}"></video>`} `}},{kind:"method",key:"updated",value:function(e){(0,r.A)((0,s.A)(a.prototype),"updated",this).call(this,e);e.has("url")&&(this._cleanUp(),this._resetError(),this._startHls())}},{kind:"method",key:"_startHls",value:async function(){var e;const t=fetch(this.url),a=(await i.e(21421).then(i.bind(i,21421))).default;if(!this.isConnected)return;let r=a.isSupported();if(r||(r=""!==this._videoEl.canPlayType("application/vnd.apple.mpegurl")),!r)return void this._setFatalError(this.hass.localize("ui.components.media-browser.video_not_supported"));const s=this.allowExoPlayer&&(null===(e=this.hass.auth.external)||void 0===e?void 0:e.config.hasExoPlayer),o=await(await t).text();if(!this.isConnected)return;const n=/#EXT-X-STREAM-INF:.*?(?:CODECS=".*?(hev1|hvc1)?\..*?".*?)?(?:\n|\r\n)(.+)/g,d=n.exec(o),l=n.exec(o);let h;h=null!==d&&null===l?new URL(d[2],this.url).href:this.url,s&&null!==d&&void 0!==d[1]?this._renderHLSExoPlayer(h):a.isSupported()?this._renderHLSPolyfill(this._videoEl,a,h):this._renderHLSNative(this._videoEl,h)}},{kind:"method",key:"_renderHLSExoPlayer",value:async function(e){this._exoPlayer=!0,window.addEventListener("resize",this._resizeExoPlayer),this.updateComplete.then((()=>(0,l.E)())).then(this._resizeExoPlayer),this._videoEl.style.visibility="hidden",await this.hass.auth.external.fireMessage({type:"exoplayer/play_hls",payload:{url:new URL(e,window.location.href).toString(),muted:this.muted}})}},{kind:"field",key:"_resizeExoPlayer",value(){return()=>{if(!this._videoEl)return;const e=this._videoEl.getBoundingClientRect();this.hass.auth.external.fireMessage({type:"exoplayer/resize",payload:{left:e.left,top:e.top,right:e.right,bottom:e.bottom}})}}},{kind:"method",key:"_isLLHLSSupported",value:function(){if(a.streamCount<=2)return!0;if(!("performance"in window)||0===performance.getEntriesByType("resource").length)return!1;const e=performance.getEntriesByType("resource")[0];return"nextHopProtocol"in e&&"h2"===e.nextHopProtocol}},{kind:"method",key:"_renderHLSPolyfill",value:async function(e,t,i){const a=new t({backBufferLength:60,fragLoadingTimeOut:3e4,manifestLoadingTimeOut:3e4,levelLoadingTimeOut:3e4,maxLiveSyncPlaybackRate:2,lowLatencyMode:this._isLLHLSSupported()});this._hlsPolyfillInstance=a,a.attachMedia(e),a.on(t.Events.MEDIA_ATTACHED,(()=>{this._resetError(),a.loadSource(i)})),a.on(t.Events.FRAG_LOADED,((e,t)=>{this._resetError()})),a.on(t.Events.ERROR,((e,i)=>{if(i.fatal)if(i.type===t.ErrorTypes.NETWORK_ERROR){switch(i.details){case t.ErrorDetails.MANIFEST_LOAD_ERROR:{let e="Error starting stream, see logs for details";void 0!==i.response&&void 0!==i.response.code&&(i.response.code>=500?e+=" (Server failure)":i.response.code>=400?e+=" (Stream never started)":e+=" ("+i.response.code+")"),this._setRetryableError(e);break}case t.ErrorDetails.MANIFEST_LOAD_TIMEOUT:this._setRetryableError("Timeout while starting stream");break;default:this._setRetryableError("Stream network error")}a.startLoad()}else i.type===t.ErrorTypes.MEDIA_ERROR?(this._setRetryableError("Error with media stream contents"),a.recoverMediaError()):this._setFatalError("Error playing stream")}))}},{kind:"method",key:"_renderHLSNative",value:async function(e,t){e.src=t,e.addEventListener("loadedmetadata",(()=>{e.play()}))}},{kind:"method",key:"_cleanUp",value:function(){this._hlsPolyfillInstance&&(this._hlsPolyfillInstance.destroy(),this._hlsPolyfillInstance=void 0),this._exoPlayer&&(window.removeEventListener("resize",this._resizeExoPlayer),this.hass.auth.external.fireMessage({type:"exoplayer/stop"}),this._exoPlayer=!1),this._videoEl&&(this._videoEl.removeAttribute("src"),this._videoEl.load())}},{kind:"method",key:"_resetError",value:function(){this._error=void 0,this._errorIsFatal=!1}},{kind:"method",key:"_setFatalError",value:function(e){this._error=e,this._errorIsFatal=!0}},{kind:"method",key:"_setRetryableError",value:function(e){this._error=e,this._errorIsFatal=!1}},{kind:"method",key:"_loadedData",value:function(){(0,d.r)(this,"load")}},{kind:"get",static:!0,key:"styles",value:function(){return o.AH`:host,video{display:block}video{width:100%;max-height:var(--video-max-height,calc(100vh - 97px))}.fatal{display:block;padding:100px 16px}.retry{display:block}`}}]}}),o.WF)},81924:(e,t,i)=>{i.d(t,{e:()=>a});const a=e=>`/api/image_proxy/${e.entity_id}?token=${e.attributes.access_token}&state=${e.state}`},95339:(e,t,i)=>{var a=i(62659),r=i(76504),s=i(80792),o=i(40924),n=i(18791),d=i(69760),l=i(80204),h=i(7383),c=i(47038),u=i(11753),v=(i(69081),i(4596),i(43638)),y=i(83378),k=i(81924);var m=function(e){return e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error",e}(m||{});(0,a.A)([(0,n.EM)("hui-image")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"entity",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"image",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"stateImage",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"cameraImage",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"cameraView",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"aspectRatio",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"filter",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"stateFilter",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"darkModeImage",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"darkModeFilter",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"fitMode",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_imageVisible",value:()=>!1},{kind:"field",decorators:[(0,n.wk)()],key:"_loadState",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_cameraImageSrc",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_loadedImageSrc",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_lastImageHeight",value:void 0},{kind:"field",key:"_intersectionObserver",value:void 0},{kind:"field",key:"_cameraUpdater",value:void 0},{kind:"field",key:"_ratio",value:()=>null},{kind:"method",key:"connectedCallback",value:function(){(0,r.A)((0,s.A)(i.prototype),"connectedCallback",this).call(this),void 0===this._loadState&&(this._loadState=m.Loading),this.cameraImage&&"live"!==this.cameraView&&this._startIntersectionObserverOrUpdates()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,r.A)((0,s.A)(i.prototype),"disconnectedCallback",this).call(this),this._stopUpdateCameraInterval(),this._stopIntersectionObserver(),this._imageVisible=void 0}},{kind:"method",key:"handleIntersectionCallback",value:function(e){this._imageVisible=e[0].isIntersecting}},{kind:"method",key:"willUpdate",value:function(e){if(e.has("hass")){const t=e.get("hass");this._shouldStartCameraUpdates(t)?this._startIntersectionObserverOrUpdates():this.hass.connected||(this._stopUpdateCameraInterval(),this._stopIntersectionObserver(),this._loadState=m.Loading,this._cameraImageSrc=void 0,this._loadedImageSrc=void 0)}e.has("_imageVisible")&&(this._imageVisible?this._shouldStartCameraUpdates()&&this._startUpdateCameraInterval():this._stopUpdateCameraInterval()),e.has("aspectRatio")&&(this._ratio=this.aspectRatio?(0,u.A)(this.aspectRatio):null),this._loadState!==m.Loading||this.cameraImage||(this._loadState=m.Loaded)}},{kind:"method",key:"render",value:function(){if(!this.hass)return o.s6;const e=Boolean(this._ratio&&this._ratio.w>0&&this._ratio.h>0),t=this.entity?this.hass.states[this.entity]:void 0,i=t?t.state:y.Hh;let a,r,s=!this.stateImage;if(this.cameraImage)"live"===this.cameraView?r=this.hass.states[this.cameraImage]:a=this._cameraImageSrc;else if(this.stateImage){const e=this.stateImage[i];e?a=e:(a=this.image,s=!0)}else a=this.darkModeImage&&this.hass.themes.darkMode?this.darkModeImage:t&&"image"===(0,c.m)(t.entity_id)?(0,k.e)(t):this.image;a&&(a=this.hass.hassUrl(a));let n=this.filter||"";if(this.hass.themes.darkMode&&this.darkModeFilter&&(n+=this.darkModeFilter),this.stateFilter&&this.stateFilter[i]&&(n+=this.stateFilter[i]),!n&&this.entity){n=(!t||h.jj.includes(i))&&s?"grayscale(100%)":""}return o.qy` <div style="${(0,l.W)({paddingBottom:e?`${(100*this._ratio.h/this._ratio.w).toFixed(2)}%`:void 0===this._lastImageHeight?"56.25%":void 0,backgroundImage:e&&this._loadedImageSrc?`url("${this._loadedImageSrc}")`:void 0,filter:this._loadState===m.Loaded||"live"===this.cameraView?n:void 0})}" class="container ${(0,d.H)({ratio:e||void 0===this._lastImageHeight,contain:"contain"===this.fitMode,fill:"fill"===this.fitMode})}"> ${this.cameraImage&&"live"===this.cameraView?o.qy` <ha-camera-stream muted .hass="${this.hass}" .stateObj="${r}" @load="${this._onVideoLoad}"></ha-camera-stream> `:void 0===a?o.s6:o.qy` <img id="image" src="${a}" @error="${this._onImageError}" @load="${this._onImageLoad}" style="${(0,l.W)({display:e||this._loadState===m.Loaded?"block":"none"})}"> `} ${this._loadState===m.Error?o.qy`<div id="brokenImage" style="${(0,l.W)({height:e?void 0:`${this._lastImageHeight}px`||"100%"})}"></div>`:"live"===this.cameraView||void 0!==a&&this._loadState!==m.Loading?"":o.qy`<div class="progress-container" style="${(0,l.W)({height:e?void 0:`${this._lastImageHeight}px`||"100%"})}"> <ha-circular-progress class="render-spinner" indeterminate size="small"></ha-circular-progress> </div>`} </div> `}},{kind:"method",key:"_shouldStartCameraUpdates",value:function(e){return!(e&&e.connected===this.hass.connected||!this.hass.connected||"live"===this.cameraView)}},{kind:"method",key:"_startIntersectionObserverOrUpdates",value:function(){"IntersectionObserver"in window?(this._intersectionObserver||(this._intersectionObserver=new IntersectionObserver(this.handleIntersectionCallback.bind(this))),this._intersectionObserver.observe(this)):(this._imageVisible=!0,this._startUpdateCameraInterval())}},{kind:"method",key:"_stopIntersectionObserver",value:function(){this._intersectionObserver&&this._intersectionObserver.disconnect()}},{kind:"method",key:"_startUpdateCameraInterval",value:function(){this._stopUpdateCameraInterval(),this._updateCameraImageSrc(),this.cameraImage&&this.isConnected&&(this._cameraUpdater=window.setInterval((()=>this._updateCameraImageSrcAtInterval()),1e4))}},{kind:"method",key:"_stopUpdateCameraInterval",value:function(){this._cameraUpdater&&(clearInterval(this._cameraUpdater),this._cameraUpdater=void 0)}},{kind:"method",key:"_onImageError",value:function(){this._loadState=m.Error}},{kind:"method",key:"_onImageLoad",value:async function(e){this._loadState=m.Loaded;const t=e.target;this._ratio&&this._ratio.w>0&&this._ratio.h>0&&(this._loadedImageSrc=t.src),await this.updateComplete,this._lastImageHeight=t.offsetHeight}},{kind:"method",key:"_onVideoLoad",value:async function(e){this._loadState=m.Loaded;const t=e.currentTarget;await this.updateComplete,this._lastImageHeight=t.offsetHeight}},{kind:"method",key:"_updateCameraImageSrcAtInterval",value:async function(){return this._loadState===m.Loading&&this._onImageError(),this._updateCameraImageSrc()}},{kind:"method",key:"_updateCameraImageSrc",value:async function(){if(!this.hass||!this.cameraImage)return;if(!this.hass.states[this.cameraImage])return void this._onImageError();const e=this.clientWidth||640;let t,i=Math.ceil(e*devicePixelRatio);this._lastImageHeight?t=Math.ceil(this._lastImageHeight*devicePixelRatio):this._ratio&&this._ratio.w>0&&this._ratio.h>0?t=Math.ceil(i*(this._ratio.h/this._ratio.w)):(i*=2,t=Math.ceil(.5625*i)),this._cameraImageSrc=await(0,v.C4)(this.hass,this.cameraImage,i,t),void 0===this._cameraImageSrc&&this._onImageError()}},{kind:"get",static:!0,key:"styles",value:function(){return o.AH`:host{display:block}.container{transition:filter .2s linear;height:100%}img{display:block;height:100%;width:100%;object-fit:cover}.progress-container{display:flex;justify-content:center;align-items:center}.ratio{position:relative;width:100%;height:0;background-position:center;background-size:cover}.ratio.fill{background-size:100% 100%}.ratio.contain{background-size:contain;background-repeat:no-repeat}.fill img{object-fit:fill}.contain img{object-fit:contain}.ratio div,.ratio img{position:absolute;top:0;left:0;width:100%;height:100%}.ratio img{visibility:hidden}#brokenImage{background:grey url("/static/images/image-broken.svg") center/36px no-repeat}`}}]}}),o.WF)}};
//# sourceMappingURL=95339.3iaqquDWu9A.js.map