export const id=29293;export const ids=[29293];export const modules={72113:(t,e,a)=>{a.a(t,(async(t,s)=>{try{a.d(e,{o:()=>p});var n=a(81408),i=a(81438),o=a(28252),r=a(84749),d=a(56601),c=a(77396),u=a(60441),h=t([c,u]);function l(t,e){let a=new Date(e);return t>2&&0===a.getHours()&&(a=(0,n.O)(a,1)),a.setMinutes(0,0,0),t>35&&a.setDate(1),t>2&&a.setHours(0),a.getTime()}function p(t,e,a,s,n,h,p){const f=(0,i.c)(e,t),_=void 0!==h&&void 0!==p;if(_&&f<=35){const a=(0,o.M)(e,t),s=(0,o.M)(p,h);s>a?e=(0,r.L)(e,s-a):a>s&&(p=(0,r.L)(p,a-s))}const m={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:l(f,e),adapters:{date:{locale:a,config:s}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:t=>t.tick&&t.tick.major?{weight:"bold"}:{}},time:{tooltipFormat:f>35?"monthyear":f>7?"date":f>2?"weekday":f>0?"datetime":"hour",minUnit:f>35?"month":f>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:n},ticks:{beginAtZero:!0,callback:t=>(0,d.ZV)(Math.abs(t),a)}}},plugins:{tooltip:{position:"nearest",filter:t=>"0"!==t.formattedValue,itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:t=>{if(f>0)return t[0].label;const e=new Date(t[0].parsed.x);return`${_?`${(0,c.sl)(e,a,s)}: `:""}${(0,u.fU)(e,a,s)} â€“ ${(0,u.fU)((0,r.L)(e,1),a,s)}`},label:t=>`${t.dataset.label}: ${(0,d.ZV)(t.parsed.y,a)} ${n}`}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,d.Yf)(a)};return _&&(m.scales.xAxisCompare={...m.scales.x,suggestedMin:h.getTime(),max:l(f,p),display:!1}),m}[c,u]=h.then?(await h)():h,s()}catch(f){s(f)}}))},31770:(t,e,a)=>{a.a(t,(async(t,s)=>{try{a.r(e),a.d(e,{HuiEnergyDevicesDetailGraphCard:()=>v});var n=a(62659),i=a(40133),o=a(42180),r=a(40924),d=a(18791),c=a(69760),u=a(45081),h=a(76502),l=(a(54373),a(41525)),p=a(74959),f=a(94027),_=a(15821),m=a(72113),g=t([l,m]);[l,m]=g.then?(await g)():g;const k="kWh";let v=(0,n.A)([(0,d.EM)("hui-energy-devices-detail-graph-card")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,d.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_chartData",value:()=>({datasets:[]})},{kind:"field",decorators:[(0,d.wk)()],key:"_chartDatasetExtra",value:()=>[]},{kind:"field",decorators:[(0,d.wk)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_start",value:()=>(0,i.R)()},{kind:"field",decorators:[(0,d.wk)()],key:"_end",value:()=>(0,o.o)()},{kind:"field",decorators:[(0,d.wk)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_hiddenStats",value:()=>new Set},{kind:"field",key:"hassSubscribeRequiredHostProps",value:()=>["_config"]},{kind:"method",key:"hassSubscribe",value:function(){var t;return[(0,l.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((t=>{this._data=t,this._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,_.xP)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?r.qy` <ha-card> ${this._config.title?r.qy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="content ${(0,c.H)({"has-header":!!this._config.title})}"> <ha-chart-base externalHidden .hass="${this.hass}" .data="${this._chartData}" .extraData="${this._chartDatasetExtra}" .options="${this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,k,this._compareStart,this._compareEnd)}" chart-type="bar" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}"></ha-chart-base> </div> </ha-card> `:r.s6}},{kind:"method",key:"_datasetHidden",value:function(t){t.stopPropagation(),this._hiddenStats.add(this._data.prefs.device_consumption[t.detail.index].stat_consumption),this.requestUpdate("_hiddenStats")}},{kind:"method",key:"_datasetUnhidden",value:function(t){t.stopPropagation(),this._hiddenStats.delete(this._data.prefs.device_consumption[t.detail.index].stat_consumption),this.requestUpdate("_hiddenStats")}},{kind:"field",key:"_createOptions",value:()=>(0,u.A)(((t,e,a,s,n,i,o)=>{const r=(0,m.o)(t,e,a,s,n,i,o);return{...r,interaction:{mode:"nearest"},plugins:{...r.plugins,legend:{display:!0,labels:{usePointStyle:!0}}}}}))},{kind:"method",key:"_processStatistics",value:function(){const t=this._data,e=t.stats,a=t.statsCompare,s=getComputedStyle(this),n={};t.prefs.device_consumption.forEach((t=>{const a=t.stat_consumption in e&&(0,p.$j)(e[t.stat_consumption])||0;n[t.stat_consumption]=a}));const i=t.prefs.device_consumption.map((t=>t.stat_consumption));i.sort(((t,e)=>n[e]-n[t]));const r=[],d=[],{data:c,dataExtras:u}=this._processDataSet(s,e,t.statsMetadata,t.prefs.device_consumption,i);if(r.push(...c),d.push(...u),a){r.push({order:0,data:[]}),d.push({show_legend:!1}),r.push({order:999,data:[],xAxisID:"xAxisCompare"}),d.push({show_legend:!1});const{data:e,dataExtras:n}=this._processDataSet(s,a,t.statsMetadata,t.prefs.device_consumption,i,!0);r.push(...e),d.push(...n)}this._start=t.start,this._end=t.end||(0,o.o)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:r},this._chartDatasetExtra=d}},{kind:"method",key:"_processDataSet",value:function(t,e,a,s,n,i=!1){const o=[],r=[];return s.forEach(((s,d)=>{var c;const u=(0,h.fI)(d,t);let l=null;const f=[];if(s.stat_consumption in e){const t=e[s.stat_consumption];let a;for(const e of t){if(null===e.change||void 0===e.change)continue;if(l===e.start)continue;const t=new Date(e.start);f.push({x:t.getTime(),y:e.change}),l=e.start,a=e.end}1===f.length&&f.push({x:a,y:0})}const _=n.indexOf(s.stat_consumption),m=!!(null!==(c=this._config)&&void 0!==c&&c.max_devices&&_>=this._config.max_devices);o.push({label:s.name||(0,p.$O)(this.hass,s.stat_consumption,a[s.stat_consumption]),hidden:this._hiddenStats.has(s.stat_consumption)||m,borderColor:i?u+"7F":u,backgroundColor:i?u+"32":u+"7F",data:f,order:1+_,stack:"devices",pointStyle:!i&&"circle",xAxisID:i?"xAxisCompare":void 0}),r.push({show_legend:!i&&!m})})),{data:o,dataExtras:r}}},{kind:"get",static:!0,key:"styles",value:function(){return r.AH`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}`}}]}}),(0,f.E)(r.WF));s()}catch(t){s(t)}}))},94061:(t,e,a)=>{a.d(e,{f:()=>i});var s=a(74396),n=a(86174);function i(t,e){const a=(0,s.a)(t);return isNaN(e)?(0,n.w)(t,NaN):e?(a.setDate(a.getDate()+e),a):a}},84749:(t,e,a)=>{a.d(e,{L:()=>i});var s=a(87930),n=a(49518);function i(t,e){return(0,s.A)(t,e*n.s0)}},87930:(t,e,a)=>{a.d(e,{A:()=>i});var s=a(74396),n=a(86174);function i(t,e){const a=+(0,s.a)(t);return(0,n.w)(t,a+e)}},39937:(t,e,a)=>{a.d(e,{P:()=>i});var s=a(74396),n=a(86174);function i(t,e){const a=(0,s.a)(t);if(isNaN(e))return(0,n.w)(t,NaN);if(!e)return a;const i=a.getDate(),o=(0,n.w)(t,a.getTime());o.setMonth(a.getMonth()+e+1,0);return i>=o.getDate()?o:(a.setFullYear(o.getFullYear(),o.getMonth(),i),a)}},10871:(t,e,a)=>{a.d(e,{z:()=>n});var s=a(74396);function n(t,e){const a=(0,s.a)(t),n=(0,s.a)(e),i=a.getTime()-n.getTime();return i<0?-1:i>0?1:i}},28252:(t,e,a)=>{a.d(e,{M:()=>o});var s=a(80345),n=a(49518),i=a(53181);function o(t,e,a){const o=(0,i.b)(t,e)/n.s0;return(0,s.u)(null==a?void 0:a.roundingMethod)(o)}},53181:(t,e,a)=>{a.d(e,{b:()=>n});var s=a(74396);function n(t,e){return+(0,s.a)(t)-+(0,s.a)(e)}},23177:(t,e,a)=>{a.d(e,{W:()=>r});var s=a(10871),n=a(74396);function i(t,e){const a=(0,n.a)(t),s=(0,n.a)(e);return 12*(a.getFullYear()-s.getFullYear())+(a.getMonth()-s.getMonth())}var o=a(57442);function r(t,e){const a=(0,n.a)(t),r=(0,n.a)(e),d=(0,s.z)(a,r),c=Math.abs(i(a,r));let u;if(c<1)u=0;else{1===a.getMonth()&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-d*c);let e=(0,s.z)(a,r)===-d;(0,o.c)((0,n.a)(t))&&1===c&&1===(0,s.z)(t,r)&&(e=!1),u=d*(c-Number(e))}return 0===u?0:u}},79113:(t,e,a)=>{a.d(e,{D:()=>n});var s=a(74396);function n(t){const e=(0,s.a)(t);return e.setHours(23,59,59,999),e}},3889:(t,e,a)=>{a.d(e,{p:()=>n});var s=a(74396);function n(t){const e=(0,s.a)(t),a=e.getMonth();return e.setFullYear(e.getFullYear(),a+1,0),e.setHours(23,59,59,999),e}},42180:(t,e,a)=>{a.d(e,{o:()=>n});var s=a(79113);function n(){return(0,s.D)(Date.now())}},72502:(t,e,a)=>{a.d(e,{e:()=>n});var s=a(74396);function n(t){return 1===(0,s.a)(t).getDate()}},57442:(t,e,a)=>{a.d(e,{c:()=>o});var s=a(79113),n=a(3889),i=a(74396);function o(t){const e=(0,i.a)(t);return+(0,s.D)(e)==+(0,n.p)(e)}},40133:(t,e,a)=>{a.d(e,{R:()=>n});var s=a(93352);function n(){return(0,s.o)(Date.now())}},81408:(t,e,a)=>{a.d(e,{O:()=>n});var s=a(84749);function n(t,e){return(0,s.L)(t,-e)}}};
//# sourceMappingURL=29293.vNLaVupv4G0.js.map