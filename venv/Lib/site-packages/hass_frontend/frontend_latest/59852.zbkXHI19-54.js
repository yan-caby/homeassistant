export const id=59852;export const ids=[59852,2526];export const modules={76502:(e,t,i)=>{i.d(t,{Vy:()=>n,fI:()=>s});var a=i(92849);const r=["#44739e","#984ea3","#00d2d5","#ff7f00","#af8d00","#7f80cd","#b3e900","#c42e60","#a65628","#f781bf","#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#fccde5","#bc80bd","#ffed6f","#c4eaff","#cf8c00","#1b9e77","#d95f02","#e7298a","#e6ab02","#a6761d","#0097ff","#00d067","#f43600","#4ba93b","#5779bb","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function n(e){return r[e%r.length]}function s(e,t){const i=t.getPropertyValue(`--graph-color-${e+1}`)||n(e);return(0,a.RQ)(i)}},80724:(e,t,i)=>{i.d(t,{t:()=>a});const a=(e,t)=>e.substring(0,t.length)===t},28048:(e,t,i)=>{i.d(t,{c:()=>g});var a=i(76502),r=i(92849),n=i(1471),s=i(47038),o=i(24081),c=i(83378),d=i(69825);const l={media_player:{paused:.5,idle:1},vacuum:{returning:.5}};let h=0;const u=new Map;function g(e,t,i){return function(e,t,i){var a;if(!i||e===c.Hh)return(0,d.a)("--history-unavailable-color",t);if(e===c.HV)return(0,d.a)("--history-unknown-color",t);const h=(0,o.mg)(i,e);if(!h)return;const u=(0,d.a)(h,t);if(!u)return;const g=(0,s.m)(i.entity_id),p=null===(a=l[g])||void 0===a?void 0:a[e];return p?(0,r.zm)((0,n.T)((0,r.Nc)((0,r.xp)(u)),p)):u}(e,t,i)||function(e,t){if(u.has(e))return u.get(e);const i=(0,a.fI)(h,t);return h++,u.set(e,i),i}(e,t)}},2526:(e,t,i)=>{i.r(t),i.d(t,{HaIconNext:()=>o});var a=i(62659),r=i(18791),n=i(51150),s=i(1683);let o=(0,a.A)([(0,r.EM)("ha-icon-next")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,r.MZ)()],key:"path",value:()=>"rtl"===n.G.document.dir?"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z":"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}]}}),s.HaSvgIcon)},33809:(e,t,i)=>{i.a(e,(async(e,t)=>{try{var a=i(62659),r=i(76504),n=i(80792),s=i(40924),o=i(18791),c=i(60348),d=i(84948),l=e([c]);c=(l.then?(await l)():l)[0];(0,a.A)([(0,o.EM)("ha-relative-time")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"datetime",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"capitalize",value:()=>!1},{kind:"field",key:"_interval",value:void 0},{kind:"method",key:"disconnectedCallback",value:function(){(0,r.A)((0,n.A)(i.prototype),"disconnectedCallback",this).call(this),this._clearInterval()}},{kind:"method",key:"connectedCallback",value:function(){(0,r.A)((0,n.A)(i.prototype),"connectedCallback",this).call(this),this.datetime&&this._startInterval()}},{kind:"method",key:"createRenderRoot",value:function(){return this}},{kind:"method",key:"firstUpdated",value:function(e){(0,r.A)((0,n.A)(i.prototype),"firstUpdated",this).call(this,e),this._updateRelative()}},{kind:"method",key:"update",value:function(e){(0,r.A)((0,n.A)(i.prototype),"update",this).call(this,e),this._updateRelative()}},{kind:"method",key:"_clearInterval",value:function(){this._interval&&(window.clearInterval(this._interval),this._interval=void 0)}},{kind:"method",key:"_startInterval",value:function(){this._clearInterval(),this._interval=window.setInterval((()=>this._updateRelative()),6e4)}},{kind:"method",key:"_updateRelative",value:function(){if(this.datetime){const e=(0,c.K)(new Date(this.datetime),this.hass.locale);this.innerHTML=this.capitalize?(0,d.Z)(e):e}else this.innerHTML=this.hass.localize("ui.components.relative_time.never")}}]}}),s.mN);t()}catch(e){t(e)}}))},12038:(e,t,i)=>{var a=i(62659),r=i(40924),n=i(18791),s=i(14126);i(1683);(0,a.A)([(0,n.EM)("ha-timeline")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.MZ)({type:Boolean,reflect:!0})],key:"label",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,reflect:!0})],key:"raised",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({reflect:!0,type:Boolean})],key:"notEnabled",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"lastItem",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:String})],key:"icon",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"moreItems",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_showMore",value:()=>!1},{kind:"method",key:"render",value:function(){return r.qy` <div class="timeline-start"> ${this.label?"":r.qy` <ha-svg-icon .path="${this.icon||"M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"}"></ha-svg-icon> `} ${this.lastItem?"":r.qy`<div class="line"></div>`} </div> <div class="content"> <slot></slot> ${this.moreItems?r.qy` <div> ${this._showMore||1===this.moreItems.length?this.moreItems:r.qy` <button class="link" @click="${this._handleShowMore}"> Show ${this.moreItems.length} more items </button> `} </div> `:""} </div> `}},{kind:"method",key:"_handleShowMore",value:function(){this._showMore=!0}},{kind:"get",static:!0,key:"styles",value:function(){return[r.AH`:host{display:flex;flex-direction:row}:host(:not([lastItem])){min-height:50px}:host([label]){margin-top:-8px;font-style:italic;color:var(--timeline-label-color,var(--secondary-text-color))}.timeline-start{display:flex;flex-direction:column;align-items:center;margin-right:8px;margin-inline-end:8px;margin-inline-start:initial;width:24px}:host([notEnabled]) ha-svg-icon{opacity:.5}ha-svg-icon{color:var(--timeline-ball-color,var(--timeline-color,var(--secondary-text-color)));border-radius:50%}:host([raised]) ha-svg-icon{transform:scale(1.3)}.line{flex:1;width:2px;background-color:var(--timeline-line-color,var(--timeline-color,var(--secondary-text-color)));margin:4px 0}.content{margin-top:2px}:host(:not([lastItem])) .content{padding-bottom:16px}:host([label]) .content{margin-top:0;padding-top:6px}`,s.og]}}]}}),r.WF)},76349:(e,t,i)=>{var a=i(62659),r=i(47420),n=i(40924),s=i(18791);i(26250),i(12731);(0,a.A)([(0,s.EM)("ha-trace-blueprint-config")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"trace",value:void 0},{kind:"method",key:"render",value:function(){return n.qy` <ha-code-editor .value="${(0,r.dump)(this.trace.blueprint_inputs||"").trimRight()}" readOnly="readOnly" dir="ltr"></ha-code-editor> `}}]}}),n.WF)},21591:(e,t,i)=>{var a=i(62659),r=i(47420),n=i(40924),s=i(18791);i(26250),i(12731);(0,a.A)([(0,s.EM)("ha-trace-config")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"trace",value:void 0},{kind:"method",key:"render",value:function(){return n.qy` <ha-code-editor .value="${(0,r.dump)(this.trace.config).trimRight()}" readOnly="readOnly" dir="ltr"></ha-code-editor> `}},{kind:"get",static:!0,key:"styles",value:function(){return[n.AH``]}}]}}),n.WF)},21054:(e,t,i)=>{i.a(e,(async(e,t)=>{try{var a=i(62659),r=i(40924),n=i(18791),s=(i(41177),i(14469)),o=e([s]);s=(o.then?(await o)():o)[0];(0,a.A)([(0,n.EM)("ha-trace-logbook")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,reflect:!0})],key:"narrow",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"logbookEntries",value:void 0},{kind:"method",key:"render",value:function(){return this.logbookEntries.length?r.qy` <ha-logbook-renderer relative-time .hass="${this.hass}" .entries="${this.logbookEntries}" .narrow="${this.narrow}"></ha-logbook-renderer> <hat-logbook-note .domain="${this.trace.domain}"></hat-logbook-note> `:r.qy`<div class="padded-box"> No Logbook entries found for this step. </div>`}},{kind:"get",static:!0,key:"styles",value:function(){return[r.AH`.padded-box{padding:16px}`]}}]}}),r.WF);t()}catch(e){t(e)}}))},10021:(e,t,i)=>{i.a(e,(async(e,t)=>{try{var a=i(62659),r=i(47420),n=i(40924),s=i(18791),o=i(69760),c=i(64854),d=(i(26250),i(12731),i(41177),i(4224)),l=i(14469),h=i(3311),u=e([c,l]);[c,l]=u.then?(await u)():u;const g=["step_config","changed_variables","logbook"];(0,a.A)([(0,s.EM)("ha-trace-path-details")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.MZ)({type:Boolean,reflect:!0})],key:"narrow",value:()=>!1},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"logbookEntries",value:void 0},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"selected",value:void 0},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"renderedNodes",value:()=>({})},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"trackedNodes",value:void 0},{kind:"field",decorators:[(0,s.wk)()],key:"_view",value:()=>"step_config"},{kind:"method",key:"render",value:function(){return n.qy` <div class="padded-box trace-info"> ${this._renderSelectedTraceInfo()} </div> <div class="tabs top"> ${g.map((e=>n.qy` <button .view="${e}" class="${(0,o.H)({active:this._view===e})}" @click="${this._showTab}"> ${this.hass.localize(`ui.panel.config.automation.trace.tabs.${e}`)} </button> `))} </div> ${"step_config"===this._view?this._renderSelectedConfig():"changed_variables"===this._view?this._renderChangedVars():this._renderLogbook()} `}},{kind:"method",key:"_renderSelectedTraceInfo",value:function(){var e;const t=this.trace.trace;if(null===(e=this.selected)||void 0===e||!e.path)return this.hass.localize("ui.panel.config.automation.trace.path.choose");const i=this.selected.path.split("/");if("default"===i[i.length-1]){var a;const e=t[i.slice(0,i.length-1).join("/")];if(e&&"default"===(null===(a=e[0])||void 0===a||null===(a=a.result)||void 0===a?void 0:a.choice))return this.hass.localize("ui.panel.config.automation.trace.path.default_action_executed")}if(!(this.selected.path in t))return this.hass.localize("ui.panel.config.automation.trace.path.no_further_execution");const s=[];let o=!1;for(const e of Object.keys(this.trace.trace)){if(o){if(e in this.renderedNodes)break}else{if(e!==this.selected.path)continue;o=!0}const i=t[e];s.push(i.map(((t,a)=>{const{path:s,timestamp:o,result:d,error:l,changed_variables:h,...u}=t;return!1===(null==d?void 0:d.enabled)?n.qy`${this.hass.localize("ui.panel.config.automation.trace.path.disabled_step")}`:n.qy` ${e===this.selected.path?"":n.qy`<h2> ${e.substring(this.selected.path.length+1)} </h2>`} ${1===i.length?n.s6:n.qy`<h3> ${this.hass.localize("ui.panel.config.automation.trace.path.iteration",{number:a+1})} </h3>`} ${this.hass.localize("ui.panel.config.automation.trace.path.executed",{time:(0,c.yg)(new Date(o),this.hass.locale,this.hass.config)})} <br> ${l?n.qy`<div class="error"> ${this.hass.localize("ui.panel.config.automation.trace.path.error",{error:l})} </div>`:n.s6} ${d?n.qy`${this.hass.localize("ui.panel.config.automation.trace.path.result")} <pre>${(0,r.dump)(d)}</pre>`:n.s6} ${0===Object.keys(u).length?n.s6:n.qy`<pre>${(0,r.dump)(u)}</pre>`} `})))}return s}},{kind:"method",key:"_renderSelectedConfig",value:function(){var e;if(null===(e=this.selected)||void 0===e||!e.path)return n.s6;const t=(0,d.Ci)(this.trace.config,this.selected.path);return t?n.qy`<ha-code-editor .value="${(0,r.dump)(t).trimEnd()}" readOnly="readOnly" dir="ltr"></ha-code-editor>`:this.hass.localize("ui.panel.config.automation.trace.path.unable_to_find_config")}},{kind:"method",key:"_renderChangedVars",value:function(){const e=this.trace.trace[this.selected.path];return void 0===e?n.qy`<div class="padded-box"> ${this.hass.localize("ui.panel.config.automation.trace.path.step_not_executed")} </div>`:n.qy` <div class="padded-box"> ${e.map(((t,i)=>n.qy` ${e.length>1?n.qy`<p> ${this.hass.localize("ui.panel.config.automation.trace.path.iteration",{number:i+1})} </p>`:""} ${0===Object.keys(t.changed_variables||{}).length?this.hass.localize("ui.panel.config.automation.trace.path.no_variables_changed"):n.qy`<pre>${(0,r.dump)(t.changed_variables).trimEnd()}</pre>`} `))} </div> `}},{kind:"method",key:"_renderLogbook",value:function(){const e=this.trace.trace,t=e[this.selected.path],i=Object.keys(this.trackedNodes),a=i.indexOf(this.selected.path);if(-1===a)return n.qy`<div class="padded-box"> ${this.hass.localize("ui.panel.config.automation.trace.path.step_not_executed")} </div>`;let r;if(a===i.length-1){const e=new Date(t[0].timestamp),i=this.logbookEntries.findIndex((t=>new Date(1e3*t.when)>=e));r=-1===i?[]:this.logbookEntries.slice(i)}else{const n=e[i[a+1]],s=new Date(t[0].timestamp),o=new Date(n[0].timestamp);r=[];for(const e of this.logbookEntries||[]){const t=new Date(1e3*e.when);if(t>=s){if(!(t<o))break;r.push(e)}}}return r.length?n.qy` <ha-logbook-renderer relative-time .hass="${this.hass}" .entries="${r}" .narrow="${this.narrow}"></ha-logbook-renderer> <hat-logbook-note .domain="${this.trace.domain}"></hat-logbook-note> `:n.qy`<div class="padded-box"> ${this.hass.localize("ui.panel.config.automation.trace.path.no_logbook_entries")} </div>`}},{kind:"method",key:"_showTab",value:function(e){this._view=e.target.view}},{kind:"get",static:!0,key:"styles",value:function(){return[h.h,n.AH`.padded-box{margin:16px}:host(:not([narrow])) .trace-info{min-height:250px}pre{margin:0}.error{color:var(--error-color)}`]}}]}}),n.WF);t()}catch(e){t(e)}}))},89450:(e,t,i)=>{i.a(e,(async(e,t)=>{try{var a=i(62659),r=i(40924),n=i(18791),s=(i(41177),i(42408)),o=e([s]);s=(o.then?(await o)():o)[0];(0,a.A)([(0,n.EM)("ha-trace-timeline")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"logbookEntries",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"selected",value:void 0},{kind:"method",key:"render",value:function(){return r.qy` <hat-trace-timeline .hass="${this.hass}" .trace="${this.trace}" .logbookEntries="${this.logbookEntries}" .selectedPath="${this.selected.path}" allowPick> </hat-trace-timeline> <hat-logbook-note .domain="${this.trace.domain}"></hat-logbook-note> `}},{kind:"get",static:!0,key:"styles",value:function(){return[r.AH`:host{display:block;padding:16px}`]}}]}}),r.WF);t()}catch(e){t(e)}}))},41177:(e,t,i)=>{var a=i(62659),r=i(40924),n=i(18791);(0,a.A)([(0,n.EM)("hat-logbook-note")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.MZ)()],key:"domain",value:()=>"automation"},{kind:"method",key:"render",value:function(){return r.qy` Not all shown logbook entries might be related to this ${this.domain}. `}},{kind:"field",static:!0,key:"styles",value:()=>r.AH`:host{display:block;text-align:center;font-style:italic;padding:16px;margin-top:8px}`}]}}),r.WF)},54818:(e,t,i)=>{var a=i(62659),r=i(76504),n=i(80792),s=i(40924),o=i(18791),c=i(68286),d=i(77664),l=i(95146),h=(i(12731),i(88680),i(69760));const u=10,g=30;(0,a.A)([(0,o.EM)("hat-graph-branch")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,o.MZ)({type:Boolean,reflect:!0})],key:"disabled",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"selected",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"start",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"short",value:()=>!1},{kind:"field",decorators:[(0,o.wk)()],key:"_branches",value:()=>[]},{kind:"field",key:"_totalWidth",value:()=>0},{kind:"field",key:"_maxHeight",value:()=>0},{kind:"method",key:"_updateBranches",value:function(e){let t=0;const i=[],a=[];e.target.assignedElements().forEach((e=>{const r=e.clientWidth,n=e.clientHeight;a.push({x:r/2+t,height:n,start:e.hasAttribute("graphStart"),end:e.hasAttribute("graphEnd"),track:e.hasAttribute("track")}),t+=r,i.push(n)})),this._totalWidth=t,this._maxHeight=Math.max(...i),this._branches=a.sort(((e,t)=>e.track&&!t.track?1:e.track&&t.track?0:-1))}},{kind:"method",key:"render",value:function(){return s.qy` <slot name="head"></slot> ${this.start?"":s.JW` <svg id="top" width="${this._totalWidth}"> ${this._branches.map((e=>e.start?"":s.JW` <path class="${(0,h.H)({track:e.track})}" d="
                      M ${this._totalWidth/2} 0
                      L ${e.x} ${20}
                      "/> `))} </svg> `} <div id="branches"> <svg id="lines" width="${this._totalWidth}" height="${this._maxHeight}"> ${this._branches.map((e=>e.end?"":s.JW` <path class="${(0,h.H)({track:e.track})}" d="
                        M ${e.x} ${e.height}
                        v ${this._maxHeight-e.height}
                        "/> `))} </svg> <slot @slotchange="${this._updateBranches}"></slot> </div> ${this.short?"":s.JW` <svg id="bottom" width="${this._totalWidth}"> ${this._branches.map((e=>e.end?"":s.JW` <path class="${(0,h.H)({track:e.track})}" d="
                      M ${e.x} 0
                      V ${u}
                      L ${this._totalWidth/2} ${30}
                      "/> `))} </svg> `} `}},{kind:"get",static:!0,key:"styles",value:function(){return s.AH`:host{position:relative;display:flex;flex-direction:column;align-items:center}:host(:focus){outline:0}#branches{position:relative;display:flex;flex-direction:row;align-items:start}::slotted(*){z-index:1}::slotted([slot=head]){margin-bottom:calc(var(--hat-graph-branch-height)/ -2)}#lines{position:absolute}#top{height:var(--hat-graph-branch-height)}#bottom{height:calc(var(--hat-graph-branch-height) + var(--hat-graph-spacing))}path{stroke:var(--stroke-clr);stroke-width:2;fill:none}path.track{stroke:var(--track-clr)}:host([disabled]) path{stroke:var(--disabled-clr)}`}}]}}),s.WF);const p=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);(0,a.A)([(0,o.EM)("hat-graph-node")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,o.MZ)()],key:"iconPath",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Boolean,reflect:!0})],key:"disabled",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"error",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({reflect:!0,type:Boolean})],key:"notEnabled",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({reflect:!0,type:Boolean})],key:"graphStart",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Boolean,attribute:"nofocus"})],key:"noFocus",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({reflect:!0,type:Number})],key:"badge",value:void 0},{kind:"method",key:"updated",value:function(e){e.has("noFocus")&&(this.hasAttribute("tabindex")||this.noFocus?void 0!==e.get("noFocus")&&this.noFocus&&this.removeAttribute("tabindex"):this.setAttribute("tabindex","0"))}},{kind:"method",key:"render",value:function(){const e=g+(this.graphStart?2:11);return s.qy` <svg class="${p?"safari":""}" width="${40}px" height="${e}px" viewBox="-${Math.ceil(20)} -${this.graphStart?Math.ceil(e/2):Math.ceil(25)} ${40} ${e}"> ${this.graphStart?s.s6:s.JW` <path class="connector" d="
              M 0 ${-25}
              L 0 0
            " line-caps="round"/> `} <g class="node"> <circle cx="0" cy="0" r="${15}"/> ${this.error?s.JW` <g class="error"> <circle cx="-12" cy="${-15}" r="8"></circle> <path transform="translate(-18 -21) scale(.5)" class="exclamation" d="${"M10 3H14V14H10V3M10 21V17H14V21H10Z"}/"> </path></g> `:s.s6} ${this.badge?s.JW` <g class="number"> <circle cx="12" cy="${-15}" r="8"></circle> <text x="12" y="${-15}" text-anchor="middle" alignment-baseline="middle">${this.badge>9?"9+":this.badge}</text> </g> `:s.s6} <g style="pointer-events:none" transform="translate(-12 -12)"> ${this.iconPath?s.JW`<path class="icon" d="${this.iconPath}/"></path>`:s.JW`<foreignObject><span class="icon"><slot name="icon"></slot></span></foreignObject>`} </g> </g> </svg> `}},{kind:"get",static:!0,key:"styles",value:function(){return s.AH`:host{display:flex;flex-direction:column;min-width:calc(var(--hat-graph-node-size) + var(--hat-graph-spacing));height:calc(var(--hat-graph-node-size) + var(--hat-graph-spacing) + 1px)}:host([graphStart]){height:calc(var(--hat-graph-node-size) + 2px)}:host([track]){--stroke-clr:var(--track-clr);--icon-clr:var(--default-icon-clr)}:host([active]) circle{--stroke-clr:var(--active-clr);--icon-clr:var(--default-icon-clr)}:host(:focus){outline:0}:host(:hover) circle{--stroke-clr:var(--hover-clr);--icon-clr:var(--default-icon-clr)}:host([notEnabled]) circle{--stroke-clr:var(--disabled-clr)}:host([notEnabled][active]) circle{--stroke-clr:var(--disabled-active-clr)}:host([notEnabled]:hover) circle{--stroke-clr:var(--disabled-hover-clr)}svg:not(.safari){width:100%;height:100%}circle,path.connector{stroke:var(--stroke-clr);stroke-width:2;fill:none}circle{fill:var(--background-clr);stroke:var(--circle-clr,var(--stroke-clr))}.error circle{fill:var(--error-color);stroke:none;stroke-width:0}.error .exclamation{fill:var(--text-primary-color)}.number circle{fill:var(--track-clr);stroke:none;stroke-width:0}.number text{font-size:10px;fill:var(--text-primary-color)}path.icon{fill:var(--icon-clr)}foreignObject{width:24px;height:24px}.icon{color:var(--icon-clr)}`}}]}}),s.WF),(0,a.A)([(0,o.EM)("hat-graph-spacer")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,o.MZ)({reflect:!0,type:Boolean})],key:"disabled",value:()=>!1},{kind:"method",key:"render",value:function(){return s.qy` <svg viewBox="-${5} 0 10 ${41}"> <path d="
              M 0 ${41}
              V 0
            " line-caps="round"/> } </svg> `}},{kind:"get",static:!0,key:"styles",value:function(){return s.AH`:host{display:flex;flex-direction:column;align-items:center}svg{width:var(--hat-graph-spacing);height:calc(var(--hat-graph-spacing) + var(--hat-graph-node-size) + 1px)}:host([track]){--stroke-clr:var(--track-clr)}:host-context([disabled]){--stroke-clr:var(--disabled-clr)}path{stroke:var(--stroke-clr);stroke-width:2;fill:none}`}}]}}),s.WF);var v=i(89107);(0,a.A)([(0,o.EM)("hat-script-graph")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"selected",value:void 0},{kind:"field",key:"hass",value:void 0},{kind:"field",key:"renderedNodes",value:()=>({})},{kind:"field",key:"trackedNodes",value:()=>({})},{kind:"method",key:"selectNode",value:function(e,t){return()=>{(0,d.r)(this,"graph-node-selected",{config:e,path:t})}}},{kind:"method",key:"render_trigger",value:function(e,t){var i;const a=`trigger/${t}`,r=this.trace&&a in this.trace.trace;return this.renderedNodes[a]={config:e,path:a},r&&(this.trackedNodes[a]=this.renderedNodes[a]),s.qy` <hat-graph-node graphStart ?track="${r}" @focus="${this.selectNode(e,a)}" ?active="${this.selected===a}" .iconPath="${"M21 13H14.4L19.1 17.7L17.7 19.1L13 14.4V21H11V14.3L6.3 19L4.9 17.6L9.4 13H3V11H9.6L4.9 6.3L6.3 4.9L11 9.6V3H13V9.4L17.6 4.8L19 6.3L14.3 11H21V13Z"}" .notEnabled="${!1===e.enabled}" .error="${null===(i=this.trace.trace[a])||void 0===i?void 0:i.some((e=>e.error))}" tabindex="${r?"0":"-1"}"></hat-graph-node> `}},{kind:"method",key:"render_condition",value:function(e,t){const i=`condition/${t}`;return this.renderedNodes[i]={config:e,path:i},this.trace&&i in this.trace.trace&&(this.trackedNodes[i]=this.renderedNodes[i]),this.render_condition_node(e,i)}},{kind:"field",key:"typeRenderers",value(){return{condition:this.render_condition_node,and:this.render_condition_node,or:this.render_condition_node,not:this.render_condition_node,service:this.render_service_node,wait_template:this.render_wait_node,wait_for_trigger:this.render_wait_node,repeat:this.render_repeat_node,choose:this.render_choose_node,if:this.render_if_node,parallel:this.render_parallel_node,other:this.render_other_node}}},{kind:"method",key:"render_action_node",value:function(e,t,i=!1,a=!1){const r=Object.keys(this.typeRenderers).find((t=>t in e))||"other";return this.renderedNodes[t]={config:e,path:t},this.trace&&t in this.trace.trace&&(this.trackedNodes[t]=this.renderedNodes[t]),this.typeRenderers[r].bind(this)(e,t,i,a)}},{kind:"method",key:"render_choose_node",value:function(e,t,i=!1,a=!1){var r,n,o;const d=this.trace.trace[t],l=d?d.map((e=>void 0===e.result||"default"===e.result.choice?"default":e.result.choice)):[],h=l.includes("default");return s.qy` <hat-graph-branch tabindex="${void 0===d?"-1":"0"}" @focus="${this.selectNode(e,t)}" ?track="${void 0!==d}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}"> <hat-graph-node .graphStart="${i}" .iconPath="${"M11,5H8L12,1L16,5H13V9.43C12.25,9.89 11.58,10.46 11,11.12V5M22,11L18,7V10C14.39,9.85 11.31,12.57 11,16.17C9.44,16.72 8.62,18.44 9.17,20C9.72,21.56 11.44,22.38 13,21.83C14.56,21.27 15.38,19.56 14.83,18C14.53,17.14 13.85,16.47 13,16.17C13.47,12.17 17.47,11.97 17.95,11.97V14.97L22,11M10.63,11.59C9.3,10.57 7.67,10 6,10V7L2,11L6,15V12C7.34,12.03 8.63,12.5 9.64,13.4C9.89,12.76 10.22,12.15 10.63,11.59Z"}" ?track="${void 0!==d}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" .error="${null===(r=this.trace.trace[t])||void 0===r?void 0:r.some((e=>e.error))}" slot="head" nofocus></hat-graph-node> ${e.choose?null===(n=(0,c.e)(e.choose))||void 0===n?void 0:n.map(((i,r)=>{const n=`${t}/choose/${r}`,o=l.includes(r);return this.renderedNodes[n]={config:e,path:n},o&&(this.trackedNodes[n]=this.renderedNodes[n]),s.qy` <div class="graph-container" ?track="${o}"> <hat-graph-node .iconPath="${!d||o?"M19,19H5V5H15V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V11H19M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z":"M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19Z"}" @focus="${this.selectNode(e,n)}" ?track="${o}" ?active="${this.selected===n}" .notEnabled="${a||!1===e.enabled}"></hat-graph-node> ${null!==i.sequence?(0,c.e)(i.sequence).map(((t,i)=>this.render_action_node(t,`${n}/sequence/${i}`,!1,a||!1===e.enabled))):""} </div> `})):""} <div ?track="${h}"> <hat-graph-spacer ?track="${h}"></hat-graph-spacer> ${null!==e.default?null===(o=(0,c.e)(e.default))||void 0===o?void 0:o.map(((i,r)=>this.render_action_node(i,`${t}/default/${r}`,!1,a||!1===e.enabled))):""} </div> </hat-graph-branch> `}},{kind:"method",key:"render_if_node",value:function(e,t,i=!1,a=!1){var r;const n=this.trace.trace[t];let o=!1,d=!1;for(const e of n||[]){var l,h;if(o||"then"!==(null===(l=e.result)||void 0===l?void 0:l.choice)||(o=!0),(d||"else"!==(null===(h=e.result)||void 0===h?void 0:h.choice))&&e.result||(d=!0),d&&o)break}return s.qy` <hat-graph-branch tabindex="${void 0===n?"-1":"0"}" @focus="${this.selectNode(e,t)}" ?track="${void 0!==n}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}"> <hat-graph-node .graphStart="${i}" .iconPath="${"M14,4L16.29,6.29L13.41,9.17L14.83,10.59L17.71,7.71L20,10V4M10,4H4V10L6.29,7.71L11,12.41V20H13V11.59L7.71,6.29"}" ?track="${void 0!==n}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" slot="head" nofocus></hat-graph-node> ${e.else?s.qy`<div class="graph-container" ?track="${d}"> <hat-graph-node .iconPath="${"M19.59,7L12,14.59L6.41,9H11V7H3V15H5V10.41L12,17.41L21,8.41"}" ?track="${d}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" nofocus></hat-graph-node>${(0,c.e)(e.else).map(((i,r)=>this.render_action_node(i,`${t}/else/${r}`,!1,a||!1===e.enabled)))} </div>`:s.qy`<hat-graph-spacer ?track="${d}"></hat-graph-spacer>`} <div class="graph-container" ?track="${o}"> <hat-graph-node .iconPath="${"M20,5.41L18.59,4L7,15.59V9H5V19H15V17H8.41"}" ?track="${o}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" nofocus></hat-graph-node> ${(0,c.e)(null!==(r=e.then)&&void 0!==r?r:[]).map(((i,r)=>this.render_action_node(i,`${t}/then/${r}`,!1,a||!1===e.enabled)))} </div> </hat-graph-branch> `}},{kind:"method",key:"render_condition_node",value:function(e,t,i=!1,a=!1){const r=this.trace.trace[t];let n=!1,o=!1,c=!1;if(r)for(const e of r)if(e.result&&(n=!0,e.result.result?o=!0:c=!0),o&&c)break;return s.qy` <hat-graph-branch @focus="${this.selectNode(e,t)}" ?track="${n}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" tabindex="${void 0===r?"-1":"0"}" short> <hat-graph-node .graphStart="${i}" slot="head" ?track="${n}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" .iconPath="${"M4 2A2 2 0 0 0 2 4V12H4V8H6V12H8V4A2 2 0 0 0 6 2H4M4 4H6V6H4M22 15.5V14A2 2 0 0 0 20 12H16V22H20A2 2 0 0 0 22 20V18.5A1.54 1.54 0 0 0 20.5 17A1.54 1.54 0 0 0 22 15.5M20 20H18V18H20V20M20 16H18V14H20M5.79 21.61L4.21 20.39L18.21 2.39L19.79 3.61Z"}" nofocus></hat-graph-node> <div style="${"width: 40px;"}" graphStart graphEnd></div> <div ?track="${o}"></div> <hat-graph-node .iconPath="${"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}" nofocus ?track="${c}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}"></hat-graph-node> </hat-graph-branch> `}},{kind:"method",key:"render_repeat_node",value:function(e,t,i=!1,a=!1){var r;const n=this.trace.trace[t],o=null===(r=this.trace)||void 0===r||null===(r=r.trace[`${t}/repeat/sequence/0`])||void 0===r?void 0:r.length;return s.qy` <hat-graph-branch tabindex="${void 0===n?"-1":"0"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}"> <hat-graph-node .graphStart="${i}" .iconPath="${"M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" slot="head" nofocus></hat-graph-node> <hat-graph-node .iconPath="${"M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z"}" ?track="${o>1}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" nofocus .badge="${o>1?o:void 0}"></hat-graph-node> <div ?track="${n}"> ${(0,c.e)(e.repeat.sequence).map(((i,r)=>this.render_action_node(i,`${t}/repeat/sequence/${r}`,!1,a||!1===e.enabled)))} </div> </hat-graph-branch> `}},{kind:"method",key:"render_service_node",value:function(e,t,i=!1,a=!1){var r;return s.qy` <hat-graph-node .graphStart="${i}" .iconPath="${e.service?void 0:"M12,5A2,2 0 0,1 14,7C14,7.24 13.96,7.47 13.88,7.69C17.95,8.5 21,11.91 21,16H3C3,11.91 6.05,8.5 10.12,7.69C10.04,7.47 10,7.24 10,7A2,2 0 0,1 12,5M22,19H2V17H22V19Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" .error="${null===(r=this.trace.trace[t])||void 0===r?void 0:r.some((e=>e.error))}" tabindex="${this.trace&&t in this.trace.trace?"0":"-1"}"> ${e.service?s.qy`<ha-service-icon slot="icon" .hass="${this.hass}" .service="${e.service}"></ha-service-icon>`:s.s6} </hat-graph-node> `}},{kind:"method",key:"render_wait_node",value:function(e,t,i=!1,a=!1){var r;return s.qy` <hat-graph-node .graphStart="${i}" .iconPath="${"M8,3A2,2 0 0,0 6,5V9A2,2 0 0,1 4,11H3V13H4A2,2 0 0,1 6,15V19A2,2 0 0,0 8,21H10V19H8V14A2,2 0 0,0 6,12A2,2 0 0,0 8,10V5H10V3M16,3A2,2 0 0,1 18,5V9A2,2 0 0,0 20,11H21V13H20A2,2 0 0,0 18,15V19A2,2 0 0,1 16,21H14V19H16V14A2,2 0 0,1 18,12A2,2 0 0,1 16,10V5H14V3H16Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" .error="${null===(r=this.trace.trace[t])||void 0===r?void 0:r.some((e=>e.error))}" tabindex="${this.trace&&t in this.trace.trace?"0":"-1"}"></hat-graph-node> `}},{kind:"method",key:"render_parallel_node",value:function(e,t,i=!1,a=!1){const r=this.trace.trace[t];return s.qy` <hat-graph-branch tabindex="${void 0===r?"-1":"0"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}"> <hat-graph-node .graphStart="${i}" .iconPath="${"M16,4.5V7H5V9H16V11.5L19.5,8M16,12.5V15H5V17H16V19.5L19.5,16"}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .notEnabled="${a||!1===e.enabled}" slot="head" nofocus></hat-graph-node> ${(0,c.e)(e.parallel).map(((i,r)=>"sequence"in i?s.qy`<div ?track="${t in this.trace.trace}"> ${(0,c.e)(i.sequence).map(((i,n)=>this.render_action_node(i,`${t}/parallel/${r}/sequence/${n}`,!1,a||!1===e.enabled)))} </div>`:this.render_action_node(i,`${t}/parallel/${r}/sequence/0`,!1,a||!1===e.enabled)))} </hat-graph-branch> `}},{kind:"method",key:"render_other_node",value:function(e,t,i=!1,a=!1){var r;return s.qy` <hat-graph-node .graphStart="${i}" .iconPath="${v.O$[(0,l.pq)(e)]||"M15,4V6H18V18H15V20H20V4M4,4V20H9V18H6V6H9V4H4Z"}" @focus="${this.selectNode(e,t)}" ?track="${t in this.trace.trace}" ?active="${this.selected===t}" .error="${null===(r=this.trace.trace[t])||void 0===r?void 0:r.some((e=>e.error))}" .notEnabled="${a||!1===e.enabled}"></hat-graph-node> `}},{kind:"method",key:"render",value:function(){const e=Object.keys(this.trackedNodes),t="trigger"in this.trace.config?(0,c.e)(this.trace.config.trigger).map(((e,t)=>this.render_trigger(e,t))):void 0;try{var i;return s.qy` <div class="parent graph-container"> ${t?s.qy`<hat-graph-branch start .short="${t.length<2}"> ${t} </hat-graph-branch>`:""} ${"condition"in this.trace.config?s.qy`${null===(i=(0,c.e)(this.trace.config.condition))||void 0===i?void 0:i.map(((e,t)=>this.render_condition(e,t)))}`:""} ${"action"in this.trace.config?s.qy`${(0,c.e)(this.trace.config.action).map(((e,t)=>this.render_action_node(e,`action/${t}`)))}`:""} ${"sequence"in this.trace.config?s.qy`${(0,c.e)(this.trace.config.sequence).map(((e,t)=>this.render_action_node(e,`sequence/${t}`,0===t)))}`:""} </div> <div class="actions"> <ha-icon-button .disabled="${0===e.length||e[0]===this.selected}" @click="${this._previousTrackedNode}" .path="${"M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"}"></ha-icon-button> <ha-icon-button .disabled="${0===e.length||e[e.length-1]===this.selected}" @click="${this._nextTrackedNode}" .path="${"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"}"></ha-icon-button> </div> `}catch(e){return s.qy` <div class="error"> Error rendering graph. Please download trace and share with the developers. </div> `}}},{kind:"method",key:"willUpdate",value:function(e){(0,r.A)((0,n.A)(i.prototype),"willUpdate",this).call(this,e),e.has("trace")&&(this.renderedNodes={},this.trackedNodes={})}},{kind:"method",key:"updated",value:function(e){if((0,r.A)((0,n.A)(i.prototype),"updated",this).call(this,e),e.has("trace")){if(!this.selected||!(this.selected in this.trackedNodes)){const e=this.trackedNodes[Object.keys(this.trackedNodes)[0]];e&&(0,d.r)(this,"graph-node-selected",e)}if(this.trace){const e=Object.keys(this.trace.trace),t=Object.keys(this.renderedNodes).sort(((t,i)=>e.indexOf(t)-e.indexOf(i))),i={},a={};for(const e of t)a[e]=this.renderedNodes[e],e in this.trackedNodes&&(i[e]=this.trackedNodes[e]);this.renderedNodes=a,this.trackedNodes=i}}}},{kind:"method",key:"_previousTrackedNode",value:function(){const e=Object.keys(this.trackedNodes),t=e.indexOf(this.selected)-1;t>=0&&(0,d.r)(this,"graph-node-selected",this.trackedNodes[e[t]])}},{kind:"method",key:"_nextTrackedNode",value:function(){const e=Object.keys(this.trackedNodes),t=e.indexOf(this.selected)+1;t<e.length&&(0,d.r)(this,"graph-node-selected",this.trackedNodes[e[t]])}},{kind:"get",static:!0,key:"styles",value:function(){return s.AH`:host{display:flex;--stroke-clr:var(--stroke-color, var(--secondary-text-color));--active-clr:var(--active-color, var(--primary-color));--track-clr:var(--track-color, var(--accent-color));--hover-clr:var(--hover-color, var(--primary-color));--disabled-clr:var(--disabled-color, var(--disabled-text-color));--disabled-active-clr:rgba(var(--rgb-primary-color), 0.5);--disabled-hover-clr:rgba(var(--rgb-primary-color), 0.7);--default-trigger-color:3,169,244;--rgb-trigger-color:var(--trigger-color, var(--default-trigger-color));--background-clr:var(--background-color, white);--default-icon-clr:var(--icon-color, black);--icon-clr:var(--stroke-clr);--hat-graph-spacing:${u}px;--hat-graph-node-size:${g}px;--hat-graph-branch-height:${20}px}.graph-container{display:flex;flex-direction:column;align-items:center}.actions{display:flex;flex-direction:column}.parent{margin-left:8px;margin-top:16px}.error{padding:16px;max-width:300px}`}}]}}),s.WF)},42408:(e,t,i)=>{i.a(e,(async(e,t)=>{try{var a=i(62659),r=i(76504),n=i(80792),s=i(26349),o=i(40924),c=i(18791),d=i(79278),l=i(64854),h=i(60348),u=i(77664),g=i(36828),p=i(2746),v=i(95146),k=i(4033),m=i(4224),f=(i(12038),e([l,h,k]));[l,h,k]=f.then?(await f)():f;const y="M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",_="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",b="M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",$="M13,2.03V2.05L13,4.05C17.39,4.59 20.5,8.58 19.96,12.97C19.5,16.61 16.64,19.5 13,19.93V21.93C18.5,21.38 22.5,16.5 21.95,11C21.5,6.25 17.73,2.5 13,2.03M11,2.06C9.05,2.25 7.19,3 5.67,4.26L7.1,5.74C8.22,4.84 9.57,4.26 11,4.06V2.06M4.26,5.67C3,7.19 2.25,9.04 2.05,11H4.05C4.24,9.58 4.8,8.23 5.69,7.1L4.26,5.67M2.06,13C2.26,14.96 3.03,16.81 4.27,18.33L5.69,16.9C4.81,15.77 4.24,14.42 4.06,13H2.06M7.1,18.37L5.67,19.74C7.18,21 9.04,21.79 11,22V20C9.58,19.82 8.23,19.25 7.1,18.37M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z",x="M13,2.03V2.05L13,4.05C17.39,4.59 20.5,8.58 19.96,12.97C19.5,16.61 16.64,19.5 13,19.93V21.93C18.5,21.38 22.5,16.5 21.95,11C21.5,6.25 17.73,2.5 13,2.03M11,2.06C9.05,2.25 7.19,3 5.67,4.26L7.1,5.74C8.22,4.84 9.57,4.26 11,4.06V2.06M4.26,5.67C3,7.19 2.25,9.04 2.05,11H4.05C4.24,9.58 4.8,8.23 5.69,7.1L4.26,5.67M2.06,13C2.26,14.96 3.03,16.81 4.27,18.33L5.69,16.9C4.81,15.77 4.24,14.42 4.06,13H2.06M7.1,18.37L5.67,19.74C7.18,21 9.04,21.79 11,22V20C9.58,19.82 8.23,19.25 7.1,18.37M16.82,15.19L12.71,11.08C13.12,10.04 12.89,8.82 12.03,7.97C11.13,7.06 9.78,6.88 8.69,7.38L10.63,9.32L9.28,10.68L7.29,8.73C6.75,9.82 7,11.17 7.88,12.08C8.74,12.94 9.96,13.16 11,12.76L15.11,16.86C15.29,17.05 15.56,17.05 15.74,16.86L16.78,15.83C17,15.65 17,15.33 16.82,15.19Z",w="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z",M=2,L=1e3,A=(e,t)=>Math.abs(t.getTime()-e.getTime())>L;class H{constructor(e,t,i){this.hass=e,this.entries=t,this.lastReportedTime=void 0,this.lastReportedTime=new Date(i.timestamp.start)}setLastReportedTime(e){this.lastReportedTime=e}renderTime(e,t){this.entries.push(o.qy` <ha-timeline label> ${(0,h.K)(e,this.hass.locale,t,!1)} later </ha-timeline> `),this.lastReportedTime=t}maybeRenderTime(e){return A(e,this.lastReportedTime)?(this.renderTime(this.lastReportedTime,e),!0):(this.lastReportedTime=e,!1)}}class q{constructor(e,t,i){this.entries=e,this.timeTracker=t,this.logbookEntries=i,this.curIndex=void 0,this.pendingItems=[],this.curIndex=i.length>0&&"automation"===i[0].domain?1:0}get curItem(){return this.logbookEntries[this.curIndex]}get hasNext(){return this.curIndex<this.logbookEntries.length}maybeRenderItem(){const e=this.curItem;this.curIndex++;const t=new Date(1e3*e.when);if(0===this.pendingItems.length)return void this.pendingItems.push([t,e]);const i=this.pendingItems[this.pendingItems.length-1][0];A(i,t)&&(this._renderLogbookEntries(),this.timeTracker.renderTime(i,t)),this.pendingItems.push([t,e])}flush(){this.pendingItems.length>0&&this._renderLogbookEntries()}_renderLogbookEntries(){this.timeTracker.maybeRenderTime(this.pendingItems[0][0]);const e=[];let t,i;for(t=0;t<Math.min(this.pendingItems.length,M);t++)e.push(this._renderLogbookEntryHelper(this.pendingItems[t][1]));if(t<this.pendingItems.length)for(i=[];t<this.pendingItems.length;t++)i.push(this._renderLogbookEntryHelper(this.pendingItems[t][1]));this.entries.push(o.qy` <ha-timeline .icon="${b}" .moreItems="${i}"> ${e} </ha-timeline> `),this.timeTracker.setLastReportedTime(this.pendingItems[this.pendingItems.length-1][0]),this.pendingItems=[]}_renderLogbookEntryHelper(e){return o.qy`${e.name} (${e.entity_id}) ${e.message||`turned ${e.state}`}<br>`}}class E{constructor(e,t,i,a,r,n,s,o){this.hass=e,this.entityReg=t,this.labelReg=i,this.floorReg=a,this.entries=r,this.trace=n,this.logbookRenderer=s,this.timeTracker=o,this.curIndex=0,this.keys=void 0,this.keys=Object.keys(n.trace)}get curItem(){return this._getItem(this.curIndex)}get hasNext(){return this.curIndex<this.keys.length}renderItem(){this.curIndex=this._renderItem(this.curIndex)}_getItem(e){return this.trace.trace[this.keys[e]]}_renderItem(e,t,i){const a=this._getItem(e);if(i){let i=0;return a.forEach((a=>{i=this._renderIteration(e,a,t)})),i}return this._renderIteration(e,a[0],t)}_renderIteration(e,t,i){if((0,m.AB)(t.path))return this._handleTrigger(e,t);const a=new Date(t.timestamp);for(;this.logbookRenderer.hasNext&&new Date(1e3*this.logbookRenderer.curItem.when)<a;)this.logbookRenderer.maybeRenderItem();this.logbookRenderer.flush(),this.timeTracker.maybeRenderTime(a);const r=t.path;let n;try{n=(0,m.Ci)(this.trace.config,r)}catch(t){return this._renderEntry(r,this.hass.localize("ui.panel.config.automation.trace.messages.path_error",{path:r})),e+1}const s=r.split("/");if(!(2===s.length)&&!i)return this._renderEntry(r,r.replace(/\//g," ")),e+1;if(i||(i=(0,v.pq)(n)),"choose"===i)return this._handleChoose(e);if("repeat"===i)return this._handleRepeat(e);if("if"===i)return this._handleIf(e);if("parallel"===i)return this._handleParallel(e);this._renderEntry(r,(0,k.u)(this.hass,this.entityReg,this.labelReg,this.floorReg,n,i),void 0,!1===n.enabled);let o=e+1;for(;o<this.keys.length&&this.keys[o].split("/").length!==s.length;o++);return o}_handleTrigger(e,t){var i,a;return this._renderEntry(t.path,this.hass.localize("ui.panel.config.automation.trace.messages.triggered_by",{triggeredBy:null!==(i=t.changed_variables.trigger)&&void 0!==i&&i.alias?"alias":"other",alias:null===(a=t.changed_variables.trigger)||void 0===a?void 0:a.alias,triggeredPath:"trigger"===t.path?"manual":"trigger",trigger:this.trace.trigger,time:(0,l.yg)(new Date(t.timestamp),this.hass.locale,this.hass.config)}),_),e+1}_handleChoose(e){var t;const i=this.keys[e],a=i.split("/").length,r=this._getItem(e)[0],n="default"===(null===(t=r.result)||void 0===t?void 0:t.choice),s=this._getDataFromPath(this.keys[e]),o=!1===s.enabled,c=s.alias||this.hass.localize("ui.panel.config.automation.trace.messages.choose");if(n)this._renderEntry(i,this.hass.localize("ui.panel.config.automation.trace.messages.default_action_executed",{name:c}),void 0,o);else if(r.result){const t="default"!==r.result.choice?r.result.choice+1:void 0,a=this._getDataFromPath(`${this.keys[e]}/choose/${r.result.choice}`),n=a?`${a.alias||this.hass.localize("ui.panel.config.automation.trace.messages.option_executed",{option:t})}`:this.hass.localize("ui.panel.config.automation.trace.messages.error",{error:r.error});this._renderEntry(i,`${c}: ${n}`,void 0,o)}else this._renderEntry(i,this.hass.localize("ui.panel.config.automation.trace.messages.no_action_executed",{name:c}),void 0,o);let d;for(d=e+1;d<this.keys.length;d++){const e=this.keys[d].split("/");if(e.length<=a)return d;if(n&&"default"===e[a+1]||!n&&"sequence"===e[a+3])break}for(;d<this.keys.length;){const e=this.keys[d];if(e.split("/").length<=a)return d;d=this._renderItem(d,(0,v.pq)(this._getDataFromPath(e)))}return d}_handleRepeat(e){const t=this.keys[e],i=t.split("/").length,a=this._getDataFromPath(this.keys[e]),r=!1===a.enabled,n=a.alias||(0,k.u)(this.hass,this.entityReg,this.labelReg,this.floorReg,a);let s;for(this._renderEntry(t,n,void 0,r),s=e+1;s<this.keys.length;s++){const e=this.keys[s];if(e.split("/").length<=i)return s;s=this._renderItem(s,(0,v.pq)(this._getDataFromPath(e)),!0)}return s}_handleIf(e){var t;const i=this.keys[e],a=i.split("/").length,r=this._getItem(e)[0],n=this._getDataFromPath(this.keys[e]),s=!1===n.enabled,o=n.alias||this.hass.localize("ui.panel.config.automation.trace.messages.if");if(null!==(t=r.result)&&void 0!==t&&t.choice){const t=this._getDataFromPath(`${this.keys[e]}/${r.result.choice}/`),a=t?t.alias||this.hass.localize("ui.panel.config.automation.trace.messages.action_executed",{action:r.result.choice}):this.hass.localize("ui.panel.config.automation.trace.messages.error",{error:r.error});this._renderEntry(i,`${o}: ${a}`,void 0,s)}else this._renderEntry(i,this.hass.localize("ui.panel.config.automation.trace.messages.no_action_executed",{name:o}),void 0,s);let c;for(c=e+1;c<this.keys.length;c++){const e=this.keys[c],t=this.keys[c].split("/");if(t.length<=a)return c;"condition"===t[a+1]||t.length<a+2||(c=this._renderItem(c,(0,v.pq)(this._getDataFromPath(e))))}return c}_handleParallel(e){const t=this.keys[e],i=t.split("/").length,a=this._getDataFromPath(this.keys[e]),r=!1===a.enabled,n=a.alias||this.hass.localize("ui.panel.config.automation.trace.messages.execute_in_parallel");let s;for(this._renderEntry(t,n,void 0,r),s=e+1;s<this.keys.length;s++){const e=this.keys[s];if(e.split("/").length<=i)return s;s=this._renderItem(s,(0,v.pq)(this._getDataFromPath(e)))}return s}_renderEntry(e,t,i=w,a=!1){this.entries.push(o.qy` <ha-timeline .icon="${i}" data-path="${e}" .notEnabled="${a}"> ${t}${a?o.qy`<span class="disabled"> ${this.hass.localize("ui.panel.config.automation.trace.messages.disabled")}</span>`:""} </ha-timeline> `)}_getDataFromPath(e){return(0,m.Ci)(this.trace.config,e)}}(0,a.A)([(0,c.EM)("hat-trace-timeline")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,c.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,c.MZ)({attribute:!1})],key:"trace",value:void 0},{kind:"field",decorators:[(0,c.MZ)({attribute:!1})],key:"logbookEntries",value:void 0},{kind:"field",decorators:[(0,c.MZ)({attribute:!1})],key:"selectedPath",value:void 0},{kind:"field",decorators:[(0,c.MZ)({type:Boolean})],key:"allowPick",value:()=>!1},{kind:"field",decorators:[(0,c.wk)(),(0,s.Fg)({context:p.ih,subscribe:!0})],key:"_entityReg",value:void 0},{kind:"field",decorators:[(0,c.wk)(),(0,s.Fg)({context:p.HD,subscribe:!0})],key:"_labelReg",value:void 0},{kind:"field",decorators:[(0,c.wk)(),(0,s.Fg)({context:p.rf,subscribe:!0})],key:"_floorReg",value:void 0},{kind:"method",key:"render",value:function(){if(!this.trace)return o.s6;const e=[],t=new H(this.hass,e,this.trace),i=new q(e,t,this.logbookEntries||[]),a=new E(this.hass,this._entityReg,this._labelReg,this._floorReg,e,this.trace,i,t);for(;a.hasNext;)a.renderItem();for(;i.hasNext;)i.maybeRenderItem();i.flush();const r=()=>(0,l.yg)(new Date(this.trace.timestamp.finish),this.hass.locale,this.hass.config),n=()=>((new Date(this.trace.timestamp.finish).getTime()-new Date(this.trace.timestamp.start).getTime())/1e3).toFixed(2);let s;if("running"===this.trace.state)s={description:this.hass.localize("ui.panel.config.automation.trace.messages.still_running"),icon:$};else if("debugged"===this.trace.state)s={description:this.hass.localize("ui.panel.config.automation.trace.messages.debugged"),icon:x};else if("finished"===this.trace.script_execution)s={description:this.hass.localize("ui.panel.config.automation.trace.messages.finished",{time:r(),executiontime:n()}),icon:_};else if("aborted"===this.trace.script_execution)s={description:this.hass.localize("ui.panel.config.automation.trace.messages.aborted",{time:r(),executiontime:n()}),icon:y};else if("cancelled"===this.trace.script_execution)s={description:this.hass.localize("ui.panel.config.automation.trace.messages.cancelled",{time:r(),executiontime:n()}),icon:y};else{let e,t,i=!1;switch(this.trace.script_execution){case"failed_conditions":e="stopped_failed_conditions";break;case"failed_single":e="stopped_failed_single";break;case"failed_max_runs":e="stopped_failed_max_runs";break;case"error":i=!0,e="stopped_error",t=o.qy`<br><br>${this.trace.error}`;break;default:i=!0,e="stopped_unknown_reason"}s={description:o.qy`${this.hass.localize(`ui.panel.config.automation.trace.messages.${e}`,{reason:this.trace.script_execution,time:r(),executiontime:n()})} ${t||""}`,icon:y,className:i?"error":void 0}}return e.push(o.qy` <ha-timeline lastItem .icon="${s.icon}" class="${(0,d.J)(s.className)}"> ${s.description} </ha-timeline> `),o.qy`${e}`}},{kind:"method",key:"updated",value:function(e){if((0,r.A)((0,n.A)(i.prototype),"updated",this).call(this,e),this.allowPick&&e.has("trace")&&this.trace&&this.selectedPath&&!(this.selectedPath in this.trace.trace)){const e=this.shadowRoot.querySelector("ha-timeline[data-path]");e&&((0,u.r)(this,"value-changed",{value:e.dataset.path}),this.selectedPath=e.dataset.path)}(e.has("trace")||e.has("selectedPath"))&&this.shadowRoot.querySelectorAll("ha-timeline[data-path]").forEach((e=>{if((0,g.j)(e,"selected",this.selectedPath===e.dataset.path),!this.allowPick||0===e.tabIndex)return;e.tabIndex=0;const t=()=>{this.selectedPath=e.dataset.path,(0,u.r)(this,"value-changed",{value:e.dataset.path})};e.addEventListener("click",t),e.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key||t()})),e.addEventListener("mouseover",(()=>{e.raised=!0})),e.addEventListener("mouseout",(()=>{e.raised=!1}))}))}},{kind:"get",static:!0,key:"styles",value:function(){return[o.AH`ha-timeline[lastItem].condition{--timeline-ball-color:var(--error-color)}ha-timeline[data-path]{cursor:pointer}ha-timeline[selected]{--timeline-ball-color:var(--primary-color)}ha-timeline:focus{outline:0;--timeline-ball-color:var(--accent-color)}.error{--timeline-ball-color:var(--error-color);color:var(--error-color)}`]}}]}}),o.WF);t()}catch(e){t(e)}}))},3311:(e,t,i)=>{i.d(t,{h:()=>a});const a=i(40924).AH`.tabs{background-color:var(--primary-background-color);border-top:1px solid var(--divider-color);border-bottom:1px solid var(--divider-color);display:flex;padding-left:4px;padding-inline-start:4px;padding-inline-end:initial}.tabs.top{border-top:none}.tabs>*{padding:2px 16px;cursor:pointer;position:relative;bottom:-1px;border:none;border-bottom:2px solid transparent;user-select:none;background:0 0;color:var(--primary-text-color);outline:0;transition:background 15ms linear}.tabs>.active{border-bottom-color:var(--primary-color)}.tabs>:focus,.tabs>:hover{background:var(--secondary-background-color)}`},86070:(e,t,i)=>{i.d(t,{cj:()=>l,dG:()=>v,rc:()=>f,gd:()=>u,a$:()=>m,$O:()=>k,gM:()=>p});var a=i(7383),r=i(47038),n=i(66596),s=i(84948);const o=(e,t)=>(e=>{switch(e){case"de":case"lb":return!0;default:return!1}})(t)?(0,s.Z)(e):e.toLocaleLowerCase(t);var c=i(83378);const d="ui.components.logbook.messages",l=["counter","proximity","sensor","zone"],h={"numeric state of":"triggered_by_numeric_state_of","state of":"triggered_by_state_of",event:"triggered_by_event",time:"triggered_by_time","time pattern":"triggered_by_time_pattern","Home Assistant stopping":"triggered_by_homeassistant_stopping","Home Assistant starting":"triggered_by_homeassistant_starting"},u=async(e,t,i)=>g(e,t,void 0,void 0,i),g=(e,t,i,a,r,n)=>{if((a||n)&&(!a||0===a.length)&&(!n||0===n.length))return Promise.resolve([]);const s={type:"logbook/get_events",start_time:t};return i&&(s.end_time=i),null!=a&&a.length&&(s.entity_ids=a),null!=n&&n.length&&(s.device_ids=n),r&&(s.context_id=r),e.callWS(s)},p=(e,t,i,a,r,n)=>{if((r||n)&&(!r||0===r.length)&&(!n||0===n.length))return Promise.reject("No entities or devices");const s={type:"logbook/event_stream",start_time:i,end_time:a};return null!=r&&r.length&&(s.entity_ids=r),null!=n&&n.length&&(s.device_ids=n),e.connection.subscribeMessage((e=>t(e)),s)},v=(e,t)=>({entity_id:e.entity_id,state:t,attributes:{device_class:null==e?void 0:e.attributes.device_class,source_type:null==e?void 0:e.attributes.source_type,has_date:null==e?void 0:e.attributes.has_date,has_time:null==e?void 0:e.attributes.has_time,entity_picture_local:a.oL.has((0,r.m)(e.entity_id))||null==e?void 0:e.attributes.entity_picture_local,entity_picture:a.oL.has((0,r.m)(e.entity_id))||null==e?void 0:e.attributes.entity_picture}}),k=(e,t)=>{for(const i in h)if(t.startsWith(i))return t.replace(i,`${e(`ui.components.logbook.${h[i]}`)}`);return t},m=(e,t,i,r,n)=>{switch(n){case"device_tracker":case"person":return"not_home"===i?t(`${d}.was_away`):"home"===i?t(`${d}.was_at_home`):t(`${d}.was_at_state`,{state:i});case"sun":return t("above_horizon"===i?`${d}.rose`:`${d}.set`);case"binary_sensor":{const n=i===a.Or,s=i===a.qg,c=r.attributes.device_class;switch(c){case"battery":if(n)return t(`${d}.was_low`);if(s)return t(`${d}.was_normal`);break;case"connectivity":if(n)return t(`${d}.was_connected`);if(s)return t(`${d}.was_disconnected`);break;case"door":case"garage_door":case"opening":case"window":if(n)return t(`${d}.was_opened`);if(s)return t(`${d}.was_closed`);break;case"lock":if(n)return t(`${d}.was_unlocked`);if(s)return t(`${d}.was_locked`);break;case"plug":if(n)return t(`${d}.was_plugged_in`);if(s)return t(`${d}.was_unplugged`);break;case"presence":if(n)return t(`${d}.was_at_home`);if(s)return t(`${d}.was_away`);break;case"safety":if(n)return t(`${d}.was_unsafe`);if(s)return t(`${d}.was_safe`);break;case"cold":case"gas":case"heat":case"moisture":case"motion":case"occupancy":case"power":case"problem":case"smoke":case"sound":case"vibration":if(n)return t(`${d}.detected_device_class`,{device_class:o(t(`component.binary_sensor.entity_component.${c}.name`),e.language)});if(s)return t(`${d}.cleared_device_class`,{device_class:o(t(`component.binary_sensor.entity_component.${c}.name`),e.language)});break;case"tamper":if(n)return t(`${d}.detected_tampering`);if(s)return t(`${d}.cleared_tampering`)}break}case"cover":switch(i){case"open":return t(`${d}.was_opened`);case"opening":return t(`${d}.is_opening`);case"closing":return t(`${d}.is_closing`);case"closed":return t(`${d}.was_closed`)}break;case"event":return t(`${d}.detected_event_no_type`);case"lock":switch(i){case"unlocked":return t(`${d}.was_unlocked`);case"locking":return t(`${d}.is_locking`);case"unlocking":return t(`${d}.is_unlocking`);case"locked":return t(`${d}.was_locked`);case"jammed":return t(`${d}.is_jammed`)}}return i===a.Or?t(`${d}.turned_on`):i===a.qg?t(`${d}.turned_off`):i===c.HV?t(`${d}.became_unknown`):i===c.Hh?t(`${d}.became_unavailable`):e.localize(`${d}.changed_to_state`,{state:r?e.formatEntityState(r,i):i})},f=e=>"sensor"!==(0,n.t)(e)||void 0===e.attributes.unit_of_measurement&&void 0===e.attributes.state_class},4224:(e,t,i)=>{i.d(t,{AB:()=>c,Ci:()=>o,E4:()=>r,d1:()=>n,gq:()=>s});var a=i(80724);const r=(e,t,i,a)=>e.callWS({type:"trace/get",domain:t,item_id:i,run_id:a}),n=(e,t,i)=>e.callWS({type:"trace/list",domain:t,item_id:i}),s=(e,t,i)=>e.callWS({type:"trace/contexts",domain:t,item_id:i}),o=(e,t)=>{const i=t.split("/").reverse();let a=e;for(;i.length;){const e=i.pop(),t=Number(e);if(isNaN(t)){const t=a[e];if(!t&&"sequence"===e)continue;a=t}else if(Array.isArray(a))a=a[t];else if(0!==t)throw new Error("If config is not an array, can only return index 0")}return a},c=e=>"trigger"===e||(0,a.t)(e,"trigger/")},14469:(e,t,i)=>{i.a(e,(async(e,t)=>{try{var a=i(62659),r=i(40924),n=i(18791),s=i(69760),o=i(80204),c=i(6699),d=i(77396),l=i(60441),h=i(33315),u=i(77664),g=i(47038),p=i(28825),v=i(28048),k=(i(37482),i(4596),i(2526),i(33809)),m=i(86070),f=i(14126),y=i(40189),_=i(5203),b=i(58587),$=e([d,l,k]);[d,l,k]=$.then?(await $)():$;const x=["script","automation"],w=e=>e.context_event_type||e.context_state||e.context_message,M=(e,t)=>t?e.replace(t," "):e;(0,a.A)([(0,n.EM)("ha-logbook-renderer")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"userIdToName",value:()=>({})},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"traceContexts",value:()=>({})},{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"entries",value:()=>[]},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"narrow"})],key:"narrow",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"virtualize",reflect:!0})],key:"virtualize",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"show-indicator"})],key:"showIndicator",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"no-icon"})],key:"noIcon",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"no-name"})],key:"noName",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean,attribute:"relative-time"})],key:"relativeTime",value:()=>!1},{kind:"field",decorators:[(0,h.a)(".container")],key:"_savedScrollPos",value:void 0},{kind:"method",key:"willUpdate",value:function(e){(!this.hasUpdated&&this.virtualize||e.has("virtualize")&&this.virtualize)&&(this.hass.loadBackendTranslation("services"),this.hass.loadBackendTranslation("title"),(0,y.i)())}},{kind:"method",key:"shouldUpdate",value:function(e){const t=e.get("hass"),i=void 0===t||t.locale!==this.hass.locale;return e.has("entries")||e.has("traceContexts")||i}},{kind:"method",key:"render",value:function(){var e;return null!==(e=this.entries)&&void 0!==e&&e.length?r.qy` <div class="container ha-scrollbar ${(0,s.H)({narrow:this.narrow,"no-name":this.noName,"no-icon":this.noIcon})}" @scroll="${this._saveScrollPos}"> ${this.virtualize?r.qy`<lit-virtualizer @visibilityChanged="${this._visibilityChanged}" scroller class="ha-scrollbar" .items="${this.entries}" .renderItem="${this._renderLogbookItem}"> </lit-virtualizer>`:this.entries.map(((e,t)=>this._renderLogbookItem(e,t)))} </div> `:r.qy` <div class="container no-entries"> ${this.hass.localize("ui.components.logbook.entries_not_found")} </div> `}},{kind:"field",key:"_renderLogbookItem",value(){return(e,t)=>{var i;if(!e||void 0===t)return r.s6;const a=this.entries[t-1],n=[],o=e.entity_id?this.hass.states[e.entity_id]:void 0,h=o?(0,m.dG)(o,e.state):void 0,u=e.entity_id?(0,g.m)(e.entity_id):e.domain,p=h||e.icon||e.state||!u||!(0,c.x)(this.hass,u)?void 0:(0,_.MR)({domain:u,type:"icon",useFallback:!0,darkOptimized:null===(i=this.hass.themes)||void 0===i?void 0:i.darkMode}),v=x.includes(e.domain)&&e.context_id in this.traceContexts?this.traceContexts[e.context_id]:void 0,k=void 0!==v;return r.qy` <div class="entry-container ${(0,s.H)({clickable:k})}" .traceLink="${v?`/config/${v.domain}/trace/${v.item_id}?run_id=${v.run_id}`:void 0}" @click="${this._handleClick}"> ${0===t||null!=e&&e.when&&null!=a&&a.when&&new Date(1e3*e.when).toDateString()!==new Date(1e3*a.when).toDateString()?r.qy` <h4 class="date"> ${(0,d.Yq)(new Date(1e3*e.when),this.hass.locale,this.hass.config)} </h4> `:r.s6} <div class="entry ${(0,s.H)({"no-entity":!e.entity_id})}"> <div class="icon-message"> ${this.noIcon?"":r.qy` <state-badge .hass="${this.hass}" .overrideIcon="${e.icon}" .overrideImage="${p}" .stateObj="${e.icon?void 0:h}" .stateColor="${!1}"></state-badge> `} ${this.showIndicator?this._renderIndicator(e):""} <div class="message-relative_time"> <div class="message"> ${this.noName?"":this._renderEntity(e.entity_id,e.name,k)} ${this._renderMessage(e,n,u,h,k)} ${this._renderContextMessage(e,n,k)} </div> <div class="secondary"> <span>${(0,l.ie)(new Date(1e3*e.when),this.hass.locale,this.hass.config)}</span> - <ha-relative-time .hass="${this.hass}" .datetime="${1e3*e.when}" capitalize></ha-relative-time> ${e.context_user_id?r.qy`${this._renderUser(e)}`:""} ${k?`- ${this.hass.localize("ui.components.logbook.show_trace")}`:""} </div> </div> </div> ${k?r.qy`<ha-icon-next></ha-icon-next>`:""} </div> </div> `}}},{kind:"method",decorators:[(0,n.Ls)({passive:!0})],key:"_saveScrollPos",value:function(e){this._savedScrollPos=e.target.scrollTop}},{kind:"method",decorators:[(0,n.Ls)({passive:!0})],key:"_visibilityChanged",value:function(e){(0,u.r)(this,"hass-logbook-live",{enable:0===e.first})}},{kind:"method",key:"_renderIndicator",value:function(e){const t=this.hass.states[e.entity_id],i=getComputedStyle(this),a={backgroundColor:void 0!==e.state?(0,v.c)(e.state,i,t):void 0};return r.qy` <div class="indicator" style="${(0,o.W)(a)}"></div> `}},{kind:"method",key:"_renderMessage",value:function(e,t,i,a,r){if(e.entity_id&&e.state)return a?(0,m.a$)(this.hass,this.hass.localize,e.state,a,i):e.state;const n=w(e);let s=e.message;if(x.includes(i)&&e.source){if(n)return"";s=(0,m.$O)(this.hass.localize,e.source)}return s?this._formatMessageWithPossibleEntity(n?M(s,e.context_entity_id):s,t,void 0,r):""}},{kind:"method",key:"_renderUser",value:function(e){const t=e.context_user_id&&this.userIdToName[e.context_user_id];return t?`- ${t}`:""}},{kind:"method",key:"_renderUnseenContextSourceEntity",value:function(e,t,i){return!e.context_entity_id||t.includes(e.context_entity_id)?"":r.qy` (${this._renderEntity(e.context_entity_id,e.context_entity_id_name,i)})`}},{kind:"method",key:"_renderContextMessage",value:function(e,t,i){if(e.context_state){const t=e.context_entity_id&&e.context_entity_id in this.hass.states?(0,m.dG)(this.hass.states[e.context_entity_id],e.context_state):void 0;return r.qy`${this.hass.localize("ui.components.logbook.triggered_by_state_of")} ${this._renderEntity(e.context_entity_id,e.context_entity_id_name,i)} ${t?(0,m.a$)(this.hass,this.hass.localize,e.context_state,t,(0,g.m)(e.context_entity_id)):e.context_state}`}var a;if("call_service"===e.context_event_type)return r.qy`${this.hass.localize("ui.components.logbook.triggered_by_service")} ${e.context_domain&&e.context_service?`${(0,b.p$)(this.hass.localize,e.context_domain)}:\n      ${this.hass.localize(`component.${e.context_domain}.services.${e.context_service}.name`)||(null===(a=this.hass.services[e.context_domain])||void 0===a||null===(a=a[e.context_service])||void 0===a?void 0:a.name)||e.context_service}`:""}`;if(!e.context_message||t.includes(e.context_entity_id))return"";if("automation_triggered"===e.context_event_type||"script_started"===e.context_event_type){const a=e.context_source?e.context_source:e.context_message.replace("triggered by ",""),n=(0,m.$O)(this.hass.localize,a);return r.qy`${this.hass.localize("automation_triggered"===e.context_event_type?"ui.components.logbook.triggered_by_automation":"ui.components.logbook.triggered_by_script")} ${this._renderEntity(e.context_entity_id,e.context_entity_id_name,i)} ${e.context_message?this._formatMessageWithPossibleEntity(n,t,void 0,i):""}`}return r.qy` ${this.hass.localize("ui.components.logbook.triggered_by")} ${e.context_name} ${this._formatMessageWithPossibleEntity(e.context_message,t,e.context_entity_id,i)} ${this._renderUnseenContextSourceEntity(e,t,i)}`}},{kind:"method",key:"_renderEntity",value:function(e,t,i){const a=e&&e in this.hass.states,n=t||a&&this.hass.states[e].attributes.friendly_name||e;return a?i?n:r.qy`<button class="link" @click="${this._entityClicked}" .entityId="${e}"> ${n} </button>`:n}},{kind:"method",key:"_formatMessageWithPossibleEntity",value:function(e,t,i,a){if(-1!==e.indexOf(".")){const i=e.split(" ");for(let e=0,n=i.length;e<n;e++)if(i[e]in this.hass.states){const n=i[e];if(t.includes(n))return"";t.push(n);const s=i.splice(e);return s.shift(),r.qy`${i.join(" ")} ${this._renderEntity(n,this.hass.states[n].attributes.friendly_name,a)} ${s.join(" ")}`}}if(i&&i in this.hass.states){const n=this.hass.states[i].attributes.friendly_name;if(n&&e.endsWith(n))return t.includes(i)?"":(t.push(i),e=e.substring(0,e.length-n.length),r.qy`${e} ${this._renderEntity(i,n,a)}`)}return e}},{kind:"method",key:"_entityClicked",value:function(e){const t=e.currentTarget.entityId;t&&(e.preventDefault(),e.stopPropagation(),(0,u.r)(this,"hass-more-info",{entityId:t}))}},{kind:"method",key:"_handleClick",value:function(e){e.currentTarget.traceLink&&((0,p.o)(e.currentTarget.traceLink),(0,u.r)(this,"closed"))}},{kind:"get",static:!0,key:"styles",value:function(){return[f.RF,f.dp,f.og,r.AH`:host([virtualize]){display:block;height:100%}.entry-container{width:100%}.entry{position:relative;display:flex;width:100%;line-height:2em;padding:8px 16px;box-sizing:border-box;border-top:1px solid var(--divider-color);justify-content:space-between;align-items:center}.indicator{background-color:var(--disabled-color);height:8px;width:8px;border-radius:4px;flex-shrink:0;margin-right:12px;margin-inline-start:initial;margin-inline-end:12px;direction:var(--direction)}ha-icon-next{color:var(--secondary-text-color)}.clickable{cursor:pointer}:not(.clickable) .entry.no-entity,:not(.clickable) .no-name .entry{cursor:default}.entry:hover{background-color:rgba(var(--rgb-primary-text-color),.04)}.narrow:not(.no-icon) .time{margin-left:32px;margin-inline-start:32px;margin-inline-end:initial;direction:var(--direction)}.message-relative_time{display:flex;flex-direction:column}.secondary{font-size:12px;line-height:1.7}.secondary a{color:var(--secondary-text-color)}.date{margin:8px 0;padding:0 16px}.icon-message{display:flex;align-items:center}.no-entries{text-align:center;color:var(--secondary-text-color)}state-badge{margin-right:16px;margin-inline-start:initial;flex-shrink:0;color:var(--state-icon-color);margin-inline-end:16px;direction:var(--direction)}.message{color:var(--primary-text-color)}.no-name .message:first-letter{text-transform:capitalize}a{color:var(--primary-color);text-decoration:none}button.link{color:var(--paper-item-icon-color);text-decoration:none}.container{max-height:var(--logbook-max-height)}.container,lit-virtualizer{height:100%}lit-virtualizer{contain:size layout!important}.narrow .entry{line-height:1.5}.narrow .icon-message state-badge{margin-left:0;margin-inline-start:0;margin-right:8px;margin-inline-end:8px;direction:var(--direction)}`]}}]}}),r.WF);t()}catch(e){t(e)}}))}};
//# sourceMappingURL=59852.zbkXHI19-54.js.map