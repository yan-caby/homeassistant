"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[29293],{94027:function(t,e,n){n.d(e,{E:function(){return l}});var a=n(66123),i=n(36683),r=n(89231),s=n(29864),o=n(83647),u=n(8364),c=n(76504),d=n(80792),h=(n(77052),n(53501),n(21950),n(68113),n(55888),n(34517),n(66274),n(22836),n(8339),n(196)),l=function(t){var e=(0,u.A)(null,(function(t,e){var n=function(e){function n(){var e;(0,r.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=(0,s.A)(this,n,[].concat(i)),t(e),e}return(0,o.A)(n,e),(0,i.A)(n)}(e);return{F:n,d:[{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,c.A)((0,d.A)(n.prototype),"connectedCallback",this).call(this),this.__checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,c.A)((0,d.A)(n.prototype),"disconnectedCallback",this).call(this),this.__unsubs){for(;this.__unsubs.length;){var t=this.__unsubs.pop();t instanceof Promise?t.then((function(t){return t()})):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,c.A)((0,d.A)(n.prototype),"updated",this).call(this,t),t.has("hass"))this.__checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var e,i=(0,a.A)(t.keys());try{for(i.s();!(e=i.n()).done;){var r=e.value;if(this.hassSubscribeRequiredHostProps.includes(r))return void this.__checkSubscribed()}}catch(s){i.e(s)}finally{i.f()}}}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"__checkSubscribed",value:function(){var t,e=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some((function(t){return void 0===e[t]}))||(this.__unsubs=this.hassSubscribe())}}]}}),t);return e}},72113:function(t,e,n){var a=n(1781),i=n(94881);n.a(t,function(){var t=a(i().mark((function t(a,r){var s,o,u,c,d,h,l,f,p,v,k,_,m;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,m=function(t,e,n,a,i,r,s){var o=(0,c.c)(e,t),u=void 0!==r&&void 0!==s;if(u&&o<=35){var v=(0,d.M)(e,t),k=(0,d.M)(s,r);k>v?e=(0,h.L)(e,k-v):v>k&&(s=(0,h.L)(s,v-k))}var m={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:_(o,e),adapters:{date:{locale:n,config:a}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},time:{tooltipFormat:o>35?"monthyear":o>7?"date":o>2?"weekday":o>0?"datetime":"hour",minUnit:o>35?"month":o>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:i},ticks:{beginAtZero:!0,callback:function(t){return(0,l.ZV)(Math.abs(t),n)}}}},plugins:{tooltip:{position:"nearest",filter:function(t){return"0"!==t.formattedValue},itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:function(t){if(o>0)return t[0].label;var e=new Date(t[0].parsed.x);return"".concat(u?"".concat((0,f.sl)(e,n,a),": "):"").concat((0,p.fU)(e,n,a)," â€“ ").concat((0,p.fU)((0,h.L)(e,1),n,a))},label:function(t){return"".concat(t.dataset.label,": ").concat((0,l.ZV)(t.parsed.y,n)," ").concat(i)}}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,l.Yf)(n)};return u&&(m.scales.xAxisCompare=Object.assign(Object.assign({},m.scales.x),{},{suggestedMin:r.getTime(),max:_(o,s),display:!1})),m},_=function(t,e){var n=new Date(e);return t>2&&0===n.getHours()&&(n=(0,u.O)(n,1)),n.setMinutes(0,0,0),t>35&&n.setDate(1),t>2&&n.setHours(0),n.getTime()},n.d(e,{o:function(){return m}}),s=n(77052),n.n(s),o=n(43859),n.n(o),u=n(81408),c=n(81438),d=n(28252),h=n(84749),l=n(56601),f=n(77396),p=n(60441),!(v=a([f,p])).then){t.next=23;break}return t.next=19,v;case 19:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=24;break;case 23:t.t0=v;case 24:k=t.t0,f=k[0],p=k[1],r(),t.next=33;break;case 30:t.prev=30,t.t2=t.catch(0),r(t.t2);case 33:case"end":return t.stop()}}),t,null,[[0,30]])})));return function(e,n){return t.apply(this,arguments)}}())},31770:function(t,e,n){var a=n(1781),i=n(94881);n.a(t,function(){var t=a(i().mark((function t(a,r){var s,o,u,c,d,h,l,f,p,v,k,_,m,g,b,y,x,A,S,w,D,M,C,E,H,P,F,O,R,q,N,U,j,z,T,Y,I,L,W,Z,V,$,G,B,J,K,Q,X,tt;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.r(e),n.d(e,{HuiEnergyDevicesDetailGraphCard:function(){return tt}}),s=n(66123),o=n(61780),u=n(6238),c=n(36683),d=n(89231),h=n(29864),l=n(83647),f=n(8364),p=n(77052),n.n(p),v=n(75658),n.n(v),k=n(21950),n.n(k),_=n(36724),n.n(_),m=n(71936),n.n(m),g=n(14460),n.n(g),b=n(848),n.n(b),y=n(43859),n.n(y),x=n(68113),n.n(x),A=n(57733),n.n(A),S=n(56262),n.n(S),w=n(66274),n.n(w),D=n(84531),n.n(D),M=n(98168),n.n(M),C=n(15445),n.n(C),E=n(24483),n.n(E),H=n(13478),n.n(H),P=n(46355),n.n(P),F=n(14612),n.n(F),O=n(53691),n.n(O),R=n(48455),n.n(R),q=n(34290),n.n(q),N=n(8339),n.n(N),U=n(40133),j=n(42180),z=n(40924),T=n(196),Y=n(69760),I=n(45081),L=n(76502),n(54373),W=n(41525),Z=n(74959),V=n(94027),$=n(15821),G=n(72113),!(B=a([W,G])).then){t.next=78;break}return t.next=74,B;case 74:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=79;break;case 78:t.t0=B;case 79:J=t.t0,W=J[0],G=J[1],"kWh",tt=(0,f.A)([(0,T.EM)("hui-energy-devices-detail-graph-card")],(function(t,e){var n=function(e){function n(){var e;(0,d.A)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return e=(0,h.A)(this,n,[].concat(i)),t(e),e}return(0,l.A)(n,e),(0,c.A)(n)}(e);return{F:n,d:[{kind:"field",decorators:[(0,T.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_chartData",value:function(){return{datasets:[]}}},{kind:"field",decorators:[(0,T.wk)()],key:"_chartDatasetExtra",value:function(){return[]}},{kind:"field",decorators:[(0,T.wk)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_start",value:function(){return(0,U.R)()}},{kind:"field",decorators:[(0,T.wk)()],key:"_end",value:function(){return(0,j.o)()}},{kind:"field",decorators:[(0,T.wk)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_hiddenStats",value:function(){return new Set}},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,e=this;return[(0,W.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){e._data=t,e._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,$.xP)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?(0,z.qy)(K||(K=(0,u.A)([" <ha-card> ",' <div class="content ','"> <ha-chart-base externalHidden .hass="','" .data="','" .extraData="','" .options="','" chart-type="bar" @dataset-hidden="','" @dataset-unhidden="','"></ha-chart-base> </div> </ha-card> '])),this._config.title?(0,z.qy)(Q||(Q=(0,u.A)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,Y.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._chartDatasetExtra,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,"kWh",this._compareStart,this._compareEnd),this._datasetHidden,this._datasetUnhidden):z.s6}},{kind:"method",key:"_datasetHidden",value:function(t){t.stopPropagation(),this._hiddenStats.add(this._data.prefs.device_consumption[t.detail.index].stat_consumption),this.requestUpdate("_hiddenStats")}},{kind:"method",key:"_datasetUnhidden",value:function(t){t.stopPropagation(),this._hiddenStats.delete(this._data.prefs.device_consumption[t.detail.index].stat_consumption),this.requestUpdate("_hiddenStats")}},{kind:"field",key:"_createOptions",value:function(){return(0,I.A)((function(t,e,n,a,i,r,s){var o=(0,G.o)(t,e,n,a,i,r,s);return Object.assign(Object.assign({},o),{},{interaction:{mode:"nearest"},plugins:Object.assign(Object.assign({},o.plugins),{},{legend:{display:!0,labels:{usePointStyle:!0}}})})}))}},{kind:"method",key:"_processStatistics",value:function(){var t=this._data,e=t.stats,n=t.statsCompare,a=getComputedStyle(this),i={};t.prefs.device_consumption.forEach((function(t){var n=t.stat_consumption in e&&(0,Z.$j)(e[t.stat_consumption])||0;i[t.stat_consumption]=n}));var r=t.prefs.device_consumption.map((function(t){return t.stat_consumption}));r.sort((function(t,e){return i[e]-i[t]}));var s=[],u=[],c=this._processDataSet(a,e,t.statsMetadata,t.prefs.device_consumption,r),d=c.data,h=c.dataExtras;if(s.push.apply(s,(0,o.A)(d)),u.push.apply(u,(0,o.A)(h)),n){s.push({order:0,data:[]}),u.push({show_legend:!1}),s.push({order:999,data:[],xAxisID:"xAxisCompare"}),u.push({show_legend:!1});var l=this._processDataSet(a,n,t.statsMetadata,t.prefs.device_consumption,r,!0),f=l.data,p=l.dataExtras;s.push.apply(s,(0,o.A)(f)),u.push.apply(u,(0,o.A)(p))}this._start=t.start,this._end=t.end||(0,j.o)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:s},this._chartDatasetExtra=u}},{kind:"method",key:"_processDataSet",value:function(t,e,n,a,i){var r=this,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=[],c=[];return a.forEach((function(a,d){var h,l=(0,L.fI)(d,t),f=null,p=[];if(a.stat_consumption in e){var v,k,_=e[a.stat_consumption],m=(0,s.A)(_);try{for(m.s();!(k=m.n()).done;){var g=k.value;if(null!==g.change&&void 0!==g.change&&f!==g.start){var b=new Date(g.start);p.push({x:b.getTime(),y:g.change}),f=g.start,v=g.end}}}catch(A){m.e(A)}finally{m.f()}1===p.length&&p.push({x:v,y:0})}var y=i.indexOf(a.stat_consumption),x=!!(null!==(h=r._config)&&void 0!==h&&h.max_devices&&y>=r._config.max_devices);u.push({label:a.name||(0,Z.$O)(r.hass,a.stat_consumption,n[a.stat_consumption]),hidden:r._hiddenStats.has(a.stat_consumption)||x,borderColor:o?l+"7F":l,backgroundColor:o?l+"32":l+"7F",data:p,order:1+y,stack:"devices",pointStyle:!o&&"circle",xAxisID:o?"xAxisCompare":void 0}),c.push({show_legend:!o&&!x})})),{data:u,dataExtras:c}}},{kind:"get",static:!0,key:"styles",value:function(){return(0,z.AH)(X||(X=(0,u.A)([".card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}"])))}}]}}),(0,V.E)(z.WF)),r(),t.next=90;break;case 87:t.prev=87,t.t2=t.catch(0),r(t.t2);case 90:case"end":return t.stop()}}),t,null,[[0,87]])})));return function(e,n){return t.apply(this,arguments)}}())},94061:function(t,e,n){n.d(e,{f:function(){return r}});var a=n(74396),i=n(86174);function r(t,e){var n=(0,a.a)(t);return isNaN(e)?(0,i.w)(t,NaN):e?(n.setDate(n.getDate()+e),n):n}},84749:function(t,e,n){n.d(e,{L:function(){return r}});var a=n(87930),i=n(49518);function r(t,e){return(0,a.A)(t,e*i.s0)}},87930:function(t,e,n){n.d(e,{A:function(){return r}});var a=n(74396),i=n(86174);function r(t,e){var n=+(0,a.a)(t);return(0,i.w)(t,n+e)}},39937:function(t,e,n){n.d(e,{P:function(){return r}});var a=n(74396),i=n(86174);function r(t,e){var n=(0,a.a)(t);if(isNaN(e))return(0,i.w)(t,NaN);if(!e)return n;var r=n.getDate(),s=(0,i.w)(t,n.getTime());return s.setMonth(n.getMonth()+e+1,0),r>=s.getDate()?s:(n.setFullYear(s.getFullYear(),s.getMonth(),r),n)}},10871:function(t,e,n){n.d(e,{z:function(){return i}});var a=n(74396);function i(t,e){var n=(0,a.a)(t),i=(0,a.a)(e),r=n.getTime()-i.getTime();return r<0?-1:r>0?1:r}},28252:function(t,e,n){n.d(e,{M:function(){return s}});var a=n(80345),i=n(49518),r=n(53181);function s(t,e,n){var s=(0,r.b)(t,e)/i.s0;return(0,a.u)(null==n?void 0:n.roundingMethod)(s)}},53181:function(t,e,n){n.d(e,{b:function(){return i}});var a=n(74396);function i(t,e){return+(0,a.a)(t)-+(0,a.a)(e)}},23177:function(t,e,n){n.d(e,{W:function(){return o}});n(650);var a=n(10871),i=n(74396);function r(t,e){var n=(0,i.a)(t),a=(0,i.a)(e);return 12*(n.getFullYear()-a.getFullYear())+(n.getMonth()-a.getMonth())}var s=n(57442);function o(t,e){var n,o=(0,i.a)(t),u=(0,i.a)(e),c=(0,a.z)(o,u),d=Math.abs(r(o,u));if(d<1)n=0;else{1===o.getMonth()&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-c*d);var h=(0,a.z)(o,u)===-c;(0,s.c)((0,i.a)(t))&&1===d&&1===(0,a.z)(t,u)&&(h=!1),n=c*(d-Number(h))}return 0===n?0:n}},79113:function(t,e,n){n.d(e,{D:function(){return i}});var a=n(74396);function i(t){var e=(0,a.a)(t);return e.setHours(23,59,59,999),e}},3889:function(t,e,n){n.d(e,{p:function(){return i}});var a=n(74396);function i(t){var e=(0,a.a)(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}},42180:function(t,e,n){n.d(e,{o:function(){return i}});var a=n(79113);function i(){return(0,a.D)(Date.now())}},72502:function(t,e,n){n.d(e,{e:function(){return i}});var a=n(74396);function i(t){return 1===(0,a.a)(t).getDate()}},57442:function(t,e,n){n.d(e,{c:function(){return s}});var a=n(79113),i=n(3889),r=n(74396);function s(t){var e=(0,r.a)(t);return+(0,a.D)(e)==+(0,i.p)(e)}},40133:function(t,e,n){n.d(e,{R:function(){return i}});var a=n(93352);function i(){return(0,a.o)(Date.now())}},81408:function(t,e,n){n.d(e,{O:function(){return i}});var a=n(84749);function i(t,e){return(0,a.L)(t,-e)}}}]);
//# sourceMappingURL=29293.mCwRUbXKNJk.js.map